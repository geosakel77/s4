{"actor": {"id": "intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad", "name": "Rocke", "created": "2020-05-26T14:20:20.623Z", "modified": "2020-06-19T20:41:21.215Z", "x_mitre_version": "1.0", "type": "intrusion-set", "aliases": ["Rocke"], "x_mitre_contributors": [], "revoked": false, "description": "[Rocke](https://attack.mitre.org/groups/G0106) is an alleged Chinese-speaking adversary whose primary objective appeared to be cryptojacking, or stealing victim system resources for the purposes of mining cryptocurrency. The name [Rocke](https://attack.mitre.org/groups/G0106) comes from the email address \"rocke@live.cn\" used to create the wallet which held collected cryptocurrency. Researchers have detected overlaps between [Rocke](https://attack.mitre.org/groups/G0106) and the Iron Cybercrime Group, though this attribution has not been confirmed.(Citation: Talos Rocke August 2018)", "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_deprecated": false, "x_mitre_attack_spec_version": "", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_domains": ["enterprise-attack"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "external_references": [{"source_name": "Talos Rocke August 2018", "url": "https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html", "external_id": "", "description": "Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020."}], "names": [], "external_tools": [], "country": [], "operations": [], "links": [], "targets": [], "external_description": [], "attck_id": "", "comment": ""}, "techniques": [{"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-04-18T17:59:24.739Z\", \"modified\": \"2025-04-15T19:58:25.266Z\", \"name\": \"Exploit Public-Facing Application\", \"description\": \"Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network. The weakness in the system can be a software bug, a temporary glitch, or a misconfiguration.\\n\\nExploited applications are often websites/web servers, but can also include databases (like SQL), standard services (like SMB or SSH), network device administration and management protocols (like SNMP and Smart Install), and any other system with Internet-accessible open sockets.(Citation: NVD CVE-2016-6662)(Citation: CIS Multiple SMB Vulnerabilities)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)(Citation: NVD CVE-2014-7169) On ESXi infrastructure, adversaries may exploit exposed OpenSLP services; they may alternatively exploit exposed VMware vCenter servers.(Citation: Recorded Future ESXiArgs Ransomware 2023)(Citation: Ars Technica VMWare Code Execution Vulnerability 2021) Depending on the flaw being exploited, this may also involve [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211) or [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203).\\n\\nIf an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs (e.g., via the [Cloud Instance Metadata API](https://attack.mitre.org/techniques/T1552/005)), exploit container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611), or take advantage of weak identity and access management policies.\\n\\nAdversaries may also exploit edge network infrastructure and related appliances, specifically targeting devices that do not support robust host-based defenses.(Citation: Mandiant Fortinet Zero Day)(Citation: Wired Russia Cyberwar)\\n\\nFor websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"initial-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1190\", \"external_id\": \"T1190\"}, {\"source_name\": \"CWE top 25\", \"description\": \"Christey, S., Brown, M., Kirby, D., Martin, B., Paller, A.. (2011, September 13). 2011 CWE/SANS Top 25 Most Dangerous Software Errors. Retrieved April 10, 2019.\", \"url\": \"https://cwe.mitre.org/top25/index.html\"}, {\"source_name\": \"CIS Multiple SMB Vulnerabilities\", \"description\": \"CIS. (2017, May 15). Multiple Vulnerabilities in Microsoft Windows SMB Server Could Allow for Remote Code Execution. Retrieved April 3, 2018.\", \"url\": \"https://www.cisecurity.org/advisory/multiple-vulnerabilities-in-microsoft-windows-smb-server-could-allow-for-remote-code-execution/\"}, {\"source_name\": \"Ars Technica VMWare Code Execution Vulnerability 2021\", \"description\": \"Dan Goodin . (2021, February 25). Code-execution flaw in VMware has a severity rating of 9.8 out of 10. Retrieved April 8, 2025.\", \"url\": \"https://arstechnica.com/information-technology/2021/02/armed-with-exploits-hackers-on-the-prowl-for-a-critical-vmware-vulnerability/\"}, {\"source_name\": \"Recorded Future ESXiArgs Ransomware 2023\", \"description\": \"German Hoeffner, Aaron Soehnen and Gianni Perez. (2023, February 7). ESXiArgs Ransomware Targets Publicly-Exposed ESXi OpenSLP Servers. Retrieved March 26, 2025.\", \"url\": \"https://www.recordedfuture.com/blog/esxiargs-ransomware-targets-vmware-esxi-openslp-servers\"}, {\"source_name\": \"Wired Russia Cyberwar\", \"description\": \"Greenberg, A. (2022, November 10). Russia\\u2019s New Cyberwarfare in Ukraine Is Fast, Dirty, and Relentless. Retrieved March 22, 2023.\", \"url\": \"https://www.wired.com/story/russia-ukraine-cyberattacks-mandiant/\"}, {\"source_name\": \"Mandiant Fortinet Zero Day\", \"description\": \"Marvi, A. et al.. (2023, March 16). Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation. Retrieved March 22, 2023.\", \"url\": \"https://www.mandiant.com/resources/blog/fortinet-malware-ecosystem\"}, {\"source_name\": \"NVD CVE-2016-6662\", \"description\": \"National Vulnerability Database. (2017, February 2). CVE-2016-6662 Detail. Retrieved April 3, 2018.\", \"url\": \"https://nvd.nist.gov/vuln/detail/CVE-2016-6662\"}, {\"source_name\": \"NVD CVE-2014-7169\", \"description\": \"National Vulnerability Database. (2017, September 24). CVE-2014-7169 Detail. Retrieved April 3, 2018.\", \"url\": \"https://nvd.nist.gov/vuln/detail/CVE-2014-7169\"}, {\"source_name\": \"Cisco Blog Legacy Device Attacks\", \"description\": \"Omar Santos. (2020, October 19). Attackers Continue to Target Legacy Devices. Retrieved October 20, 2020.\", \"url\": \"https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954\"}, {\"source_name\": \"OWASP Top 10\", \"description\": \"OWASP. (2018, February 23). OWASP Top Ten Project. Retrieved April 3, 2018.\", \"url\": \"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project\"}, {\"source_name\": \"US-CERT TA18-106A Network Infrastructure Devices 2018\", \"description\": \"US-CERT. (2018, April 20). Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://us-cert.cisa.gov/ncas/alerts/TA18-106A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Yossi Weizman, Azure Defender Research Team\", \"Praetorian\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Content\", \"Application Log: Application Log Content\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Containers\", \"IaaS\", \"Linux\", \"Network Devices\", \"Windows\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"2.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--06508c23-746d-4894-b414-cff925692bd5\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.751Z\", \"modified\": \"2025-04-28T15:32:54.599Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) exploited Apache Struts, Oracle WebLogic (CVE-2017-10271), and Adobe ColdFusion (CVE-2017-3066) vulnerabilities to deliver malware.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:26.496Z\", \"modified\": \"2025-04-16T20:37:15.308Z\", \"name\": \"Rootkit\", \"description\": \"Adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits are programs that hide the existence of malware by intercepting/hooking and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) \\n\\nRootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a hypervisor, Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1014\", \"external_id\": \"T1014\"}, {\"source_name\": \"CrowdStrike Linux Rootkit\", \"description\": \"Kurtz, G. (2012, November 19). HTTP iframe Injecting Linux Rootkit. Retrieved December 21, 2017.\", \"url\": \"https://www.crowdstrike.com/blog/http-iframe-injecting-linux-rootkit/\"}, {\"source_name\": \"BlackHat Mac OSX Rootkit\", \"description\": \"Pan, M., Tsai, S. (2014). You can\\u2019t see me: A Mac OS X Rootkit uses the tricks you haven't known yet. Retrieved December 21, 2017.\", \"url\": \"http://www.blackhat.com/docs/asia-14/materials/Tsai/WP-Asia-14-Tsai-You-Cant-See-Me-A-Mac-OS-X-Rootkit-Uses-The-Tricks-You-Havent-Known-Yet.pdf\"}, {\"source_name\": \"Symantec Windows Rootkits\", \"description\": \"Symantec. (n.d.). Windows Rootkit Overview. Retrieved December 21, 2017.\", \"url\": \"https://www.symantec.com/avcenter/reference/windows.rootkit.overview.pdf\"}, {\"source_name\": \"Wikipedia Rootkit\", \"description\": \"Wikipedia. (2016, June 1). Rootkit. Retrieved June 2, 2016.\", \"url\": \"https://en.wikipedia.org/wiki/Rootkit\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Drive: Drive Modification\", \"Firmware: Firmware Modification\", \"File: File Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Some rootkit protections may be built into anti-virus or operating system software. There are dedicated rootkit detection tools that look for specific types of rootkit behavior. Monitor for the existence of unrecognized DLLs, devices, services, and changes to the MBR. (Citation: Wikipedia Rootkit)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--2107aab0-0191-46d1-abec-8d98ac916c21\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-19T20:41:21.297Z\", \"modified\": \"2025-04-28T15:38:53.445Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:32.662Z\", \"modified\": \"2025-04-15T19:58:59.251Z\", \"name\": \"Obfuscated Files or Information\", \"description\": \"Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. \\n\\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) for [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also use compressed or archived scripts, such as JavaScript. \\n\\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\\n\\nAdversaries may also abuse [Command Obfuscation](https://attack.mitre.org/techniques/T1027/010) to obscure commands executed from payloads or directly via [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017) \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1027\", \"external_id\": \"T1027\"}, {\"source_name\": \"Volexity PowerDuke November 2016\", \"description\": \"Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.\", \"url\": \"https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/\"}, {\"source_name\": \"GitHub Revoke-Obfuscation\", \"description\": \"Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018.\", \"url\": \"https://github.com/danielbohannon/Revoke-Obfuscation\"}, {\"source_name\": \"FireEye Obfuscation June 2017\", \"description\": \"Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018.\", \"url\": \"https://web.archive.org/web/20170923102302/https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html\"}, {\"source_name\": \"FireEye Revoke-Obfuscation July 2017\", \"description\": \"Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved November 17, 2024.\", \"url\": \"https://www.blackhat.com/docs/us-17/thursday/us-17-Bohannon-Revoke-Obfuscation-PowerShell-Obfuscation-Detection-And%20Evasion-Using-Science-wp.pdf\"}, {\"source_name\": \"GitHub Office-Crackros Aug 2016\", \"description\": \"Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018.\", \"url\": \"https://github.com/itsreallynick/office-crackros\"}, {\"source_name\": \"Linux/Cdorked.A We Live Security Analysis\", \"description\": \"Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017.\", \"url\": \"https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/\"}, {\"source_name\": \"Carbon Black Obfuscation Sept 2016\", \"description\": \"Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018.\", \"url\": \"https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/\"}, {\"source_name\": \"PaloAlto EncodedCommand March 2017\", \"description\": \"White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018.\", \"url\": \"https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Red Canary\", \"Christiaan Beek, @ChristiaanBeek\"], \"x_mitre_data_sources\": [\"WMI: WMI Creation\", \"Script: Script Execution\", \"File: File Creation\", \"Module: Module Load\", \"Application Log: Application Log Content\", \"Command: Command Execution\", \"File: File Metadata\", \"Process: OS API Execution\", \"Windows Registry: Windows Registry Key Creation\", \"Process: Process Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Detection of file obfuscation is difficult unless artifacts are left behind by the obfuscation process that are uniquely detectable with a signature. If detection of the obfuscation itself is not possible, it may be possible to detect the malicious activity that caused the obfuscated file (for example, the method that was used to write, read, or modify the file on the file system). \\n\\nFlag and analyze commands containing indicators of obfuscation and known suspicious syntax such as uninterpreted escape characters like '''^''' and '''\\\"'''. Windows' Sysmon and Event ID 4688 displays command-line arguments for processes. Deobfuscation tools can be used to detect these indicators in files/payloads. (Citation: GitHub Revoke-Obfuscation) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: GitHub Office-Crackros Aug 2016) \\n\\nObfuscation used in payloads for Initial Access can be detected at the network. Use network intrusion detection systems and email gateway filtering to identify compressed and encrypted attachments and scripts. Some email attachment detonation systems can open compressed and encrypted attachments. Payloads delivered over an encrypted connection from a website require encrypted network traffic inspection. \\n\\nThe first detection of a malicious tool may trigger an anti-virus or other security tool alert. Similar events may also occur at the boundary through network IDS, email scanning appliance, etc. The initial detection should be treated as an indication of a potentially more invasive intrusion. The alerting system should be thoroughly investigated beyond that initial alert for activity that was not detected. Adversaries may continue with an operation, assuming that individual events like an anti-virus detect will not be investigated or that an analyst will not be able to conclusively link that event to other activity occurring on the network. \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"1.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--277971c7-d42e-497f-8df4-be5b4bc094f8\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.290Z\", \"modified\": \"2025-04-28T15:39:58.767Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has modified UPX headers after packing files to break unpackers.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--830c9528-df21-472c-8c14-a036bf17d665\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:31:13.915Z\", \"modified\": \"2025-04-15T19:58:47.211Z\", \"name\": \"Web Service\", \"description\": \"Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites, cloud services, and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google, Microsoft, or Twitter, makes it easier for adversaries to hide in expected noise.(Citation: Broadcom BirdyClient Microsoft Graph API 2024) Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\\n\\nUse of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1102\", \"external_id\": \"T1102\"}, {\"source_name\": \"Broadcom BirdyClient Microsoft Graph API 2024\", \"description\": \"Broadcom. (2024, May 2). BirdyClient malware leverages Microsoft Graph API for C&C communication. Retrieved July 1, 2024.\", \"url\": \"https://www.broadcom.com/support/security-center/protection-bulletin/birdyclient-malware-leverages-microsoft-graph-api-for-c-c-communication\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Anastasios Pingios\", \"Sarathkumar Rajendran, Microsoft Defender365\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Flow\", \"Network Traffic: Network Traffic Content\", \"Network Traffic: Network Connection Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"ESXi\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--29552ed5-ecfd-4a97-a6c9-d6da25181e1a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.355Z\", \"modified\": \"2025-04-28T15:40:20.490Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used Pastebin, Gitee, and GitLab for Command and Control.(Citation: Anomali Rocke March 2019)(Citation: Talos Rocke August 2018)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--830c9528-df21-472c-8c14-a036bf17d665\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}, {\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-21T21:00:48.814Z\", \"modified\": \"2025-04-15T19:58:31.395Z\", \"name\": \"Disable or Modify System Firewall\", \"description\": \"Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.\\n\\nModifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e. [Non-Standard Port](https://attack.mitre.org/techniques/T1571)).(Citation: change_rdp_port_conti)\\n\\nAdversaries may also modify host networking settings that indirectly manipulate system firewalls, such as interface bandwidth or network connection request thresholds.(Citation: Huntress BlackCat) Settings related to enabling abuse of various [Remote Services](https://attack.mitre.org/techniques/T1021) may also indirectly modify firewall rules.\\n\\nIn ESXi, firewall rules may be modified directly via the esxcli command line interface (e.g., via `esxcli network firewall set`) or via the vCenter user interface.(Citation: Trellix Rnasomhouse 2024)(Citation: Broadcom ESXi Firewall)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1562/004\", \"external_id\": \"T1562.004\"}, {\"source_name\": \"Broadcom ESXi Firewall\", \"description\": \"Broadcom. (2025, March 24). Add Allowed IP Addresses for an ESXi Host by Using the VMware Host Client. Retrieved March 26, 2025.\", \"url\": \"https://techdocs.broadcom.com/us/en/vmware-cis/vsphere/vsphere/7-0/add-allowed-ip-addresses-for-an-esxi-host-by-using-the-vmware-host-client.html\"}, {\"source_name\": \"Huntress BlackCat\", \"description\": \"Carvey, H. (2024, February 28). BlackCat Ransomware Affiliate TTPs. Retrieved March 27, 2024.\", \"url\": \"https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps\"}, {\"source_name\": \"Trellix Rnasomhouse 2024\", \"description\": \"Pham Duy Phuc, Max Kersten, No\\u00ebl Keijzer, and Micha\\u00ebl Schrijver. (2024, February 14). RansomHouse am See. Retrieved March 26, 2025.\", \"url\": \"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/\"}, {\"source_name\": \"change_rdp_port_conti\", \"description\": \"The DFIR Report. (2022, March 1). \\\"Change RDP port\\\" #ContiLeaks. Retrieved September 12, 2024.\", \"url\": \"https://x.com/TheDFIRReport/status/1498657772254240768\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Firewall: Firewall Rule Modification\", \"Windows Registry: Windows Registry Key Modification\", \"Command: Command Execution\", \"Firewall: Firewall Disable\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor processes and command-line arguments to see if firewalls are disabled or modified. Monitor Registry edits to keys that manage firewalls.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"Network Devices\", \"Windows\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--30d1528d-6a50-47b2-ab5c-eb9074adc716\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.674Z\", \"modified\": \"2025-04-28T15:41:37.192Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--a9d4b653-6915-42af-98b2-5758c4ceee56\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-09T14:15:05.330Z\", \"modified\": \"2025-04-15T19:58:56.647Z\", \"name\": \"Unix Shell\", \"description\": \"Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux, macOS, and ESXi systems, though many variations of the Unix shell exist (e.g. sh, ash, bash, zsh, etc.) depending on the specific OS or distribution.(Citation: DieNet Bash)(Citation: Apple ZShell) Unix shells can control every aspect of a system, with certain commands requiring elevated privileges.\\n\\nUnix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems.\\n\\nAdversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence.\\n\\nSome systems, such as embedded devices, lightweight Linux distributions, and ESXi servers, may leverage stripped-down Unix shells via Busybox, a small executable that contains a variety of tools, including a simple shell.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"execution\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1059/004\", \"external_id\": \"T1059.004\"}, {\"source_name\": \"Apple ZShell\", \"description\": \"Apple. (2020, January 28). Use zsh as the default shell on your Mac. Retrieved June 12, 2020.\", \"url\": \"https://support.apple.com/HT208050\"}, {\"source_name\": \"DieNet Bash\", \"description\": \"die.net. (n.d.). bash(1) - Linux man page. Retrieved June 12, 2020.\", \"url\": \"https://linux.die.net/man/1/bash\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Process: Process Creation\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Unix shell usage may be common on administrator, developer, or power user systems, depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\\n\\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script. \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"Network Devices\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--31e01486-8827-41cd-a21b-dc420554d1bb\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.747Z\", \"modified\": \"2025-04-28T15:41:49.650Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--a9d4b653-6915-42af-98b2-5758c4ceee56\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:31:04.307Z\", \"modified\": \"2025-04-15T19:58:21.308Z\", \"name\": \"System Information Discovery\", \"description\": \"An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\\n\\nTools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) On ESXi servers, threat actors may gather system information from various esxcli utilities, such as `system hostname get`, `system version get`, and `storage filesystem list` (to list storage volumes).(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)(Citation: Varonis)\\n\\nInfrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)\\n\\n[System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques) \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1082\", \"external_id\": \"T1082\"}, {\"source_name\": \"Amazon Describe Instance\", \"description\": \"Amazon. (n.d.). describe-instance-information. Retrieved March 3, 2020.\", \"url\": \"https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html\"}, {\"source_name\": \"Google Instances Resource\", \"description\": \"Google. (n.d.). Rest Resource: instance. Retrieved March 3, 2020.\", \"url\": \"https://cloud.google.com/compute/docs/reference/rest/v1/instances\"}, {\"source_name\": \"Varonis\", \"description\": \"Jason Hill. (2023, February 8). VMware ESXi in the Line of Ransomware Fire. Retrieved March 26, 2025.\", \"url\": \"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire\"}, {\"source_name\": \"Crowdstrike Hypervisor Jackpotting Pt 2 2021\", \"description\": \"Michael Dawson. (2021, August 30). Hypervisor Jackpotting, Part 2: eCrime Actors Increase Targeting of ESXi Servers with Ransomware. Retrieved March 26, 2025.\", \"url\": \"https://www.crowdstrike.com/en-us/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/\"}, {\"source_name\": \"Microsoft Virutal Machine API\", \"description\": \"Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019.\", \"url\": \"https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get\"}, {\"source_name\": \"20 macOS Common Tools and Techniques\", \"description\": \"Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.\", \"url\": \"https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/\"}, {\"source_name\": \"OSX.FairyTale\", \"description\": \"Phile Stokes. (2018, September 20). On the Trail of OSX.FairyTale | Adware Playing at Malware. Retrieved August 24, 2021.\", \"url\": \"https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/\"}, {\"source_name\": \"US-CERT-TA18-106A\", \"description\": \"US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-106A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Maril Vernon @shewhohacks\", \"Praetorian\", \"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Process: OS API Execution\", \"Process: Process Creation\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\\n\\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather  detailed system information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use  commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nIn cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"2.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--322876d6-1b49-43d8-9e4a-590919d1f930\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.232Z\", \"modified\": \"2025-04-28T15:41:53.312Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used uname -m to collect the name and information about the infected system's kernel.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:56.776Z\", \"modified\": \"2025-04-15T19:58:21.401Z\", \"name\": \"Application Layer Protocol\", \"description\": \"Adversaries may communicate using OSI application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, DNS, or publishing/subscribing. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.(Citation: Mandiant APT29 Eye Spy Email Nov 22) \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1071\", \"external_id\": \"T1071\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}, {\"source_name\": \"Mandiant APT29 Eye Spy Email Nov 22\", \"description\": \"Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.\", \"url\": \"https://www.mandiant.com/resources/blog/unc3524-eye-spy-email\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Duane Michael\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Flow\", \"Network Traffic: Network Traffic Content\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"2.4\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--37327da8-efd3-48c0-9f91-38f384f8579e\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.391Z\", \"modified\": \"2025-04-28T15:42:53.312Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) issued wget requests from infected systems to the C2.(Citation: Talos Rocke August 2018)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:31:16.408Z\", \"modified\": \"2025-04-15T19:59:17.217Z\", \"name\": \"Ingress Tool Transfer\", \"description\": \"Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as [ftp](https://attack.mitre.org/software/S0095). Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). \\n\\nOn Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, [certutil](https://attack.mitre.org/software/S0160), and [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands such as <code>IEX(New-Object Net.WebClient).downloadString()</code> and <code>Invoke-WebRequest</code>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)  A number of these tools, such as `wget`, `curl`, and `scp`, also exist on ESXi. After downloading a file, a threat actor may attempt to verify its integrity by checking its hash value (e.g., via `certutil -hashfile`).(Citation: Google Cloud Threat Intelligence COSCMICENERGY 2023)\\n\\nAdversaries may also abuse installers and package managers, such as `yum` or `winget`, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows `search-ms` protocol handler, to deliver malicious files to victims through remote file searches invoked by [User Execution](https://attack.mitre.org/techniques/T1204) (typically after interacting with [Phishing](https://attack.mitre.org/techniques/T1566) lures).(Citation: T1105: Trellix_search-ms)\\n\\nFiles can also be transferred using various [Web Service](https://attack.mitre.org/techniques/T1102)s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016) In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.(Citation: Dropbox Malware Sync)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1105\", \"external_id\": \"T1105\"}, {\"source_name\": \"T1105: Trellix_search-ms\", \"description\": \" Mathanraj Thangaraju, Sijo Jacob. (2023, July 26). Beyond File Search: A Novel Method for Exploiting the \\\"search-ms\\\" URI Protocol Handler. Retrieved March 15, 2024.\", \"url\": \"https://www.trellix.com/blogs/research/beyond-file-search-a-novel-method/\"}, {\"source_name\": \"Google Cloud Threat Intelligence COSCMICENERGY 2023\", \"description\": \"COSMICENERGY: New OT Malware Possibly Related To Russian Emergency Response Exercises. (2023, May 25). Ken Proska, Daniel Kapellmann Zafra, Keith Lunden, Corey Hildebrandt, Rushikesh Nandedkar, Nathan Brubaker. Retrieved March 18, 2025.\", \"url\": \"https://cloud.google.com/blog/topics/threat-intelligence/cosmicenergy-ot-malware-russian-response/\"}, {\"source_name\": \"Dropbox Malware Sync\", \"description\": \"David Talbot. (2013, August 21). Dropbox and Similar Services Can Sync Malware. Retrieved May 31, 2023.\", \"url\": \"https://www.technologyreview.com/2013/08/21/83143/dropbox-and-similar-services-can-sync-malware/\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}, {\"source_name\": \"t1105_lolbas\", \"description\": \"LOLBAS. (n.d.). LOLBAS Mapped to T1105. Retrieved March 11, 2022.\", \"url\": \"https://lolbas-project.github.io/#t1105\"}, {\"source_name\": \"PTSecurity Cobalt Dec 2016\", \"description\": \"Positive Technologies. (2016, December 16). Cobalt Snatch. Retrieved October 9, 2018.\", \"url\": \"https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"John Page (aka hyp3rlinx), ApparitionSec\", \"Mark Wee\", \"Shailesh Tiwary (Indian Army)\", \"The DFIR Report\", \"Alain Homewood\", \"Joe Wise\", \"Jeremy Hedges\", \"Selena Larson, @selenalarson\", \"Peter Oakes\"], \"x_mitre_data_sources\": [\"File: File Creation\", \"Network Traffic: Network Traffic Content\", \"Network Traffic: Network Traffic Flow\", \"Command: Command Execution\", \"Network Traffic: Network Connection Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as [ftp](https://attack.mitre.org/software/S0095), that does not normally occur may also be suspicious.\\n\\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <code>netsh interface portproxy</code> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"2.5\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--3e039f64-08da-4bb3-b8d5-1ed6428980ac\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.750Z\", \"modified\": \"2025-04-28T15:44:10.863Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) used malware to download additional malicious files to the target system.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--a718a0c8-5768-41a1-9958-a1cc3f995e99\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2024-09-25T13:34:30.100Z\", \"modified\": \"2025-04-15T22:08:46.014Z\", \"name\": \"Compute Hijacking\", \"description\": \"Adversaries may leverage the compute resources of co-opted systems to complete resource-intensive tasks, which may impact system and/or hosted service availability. \\n\\nOne common purpose for [Compute Hijacking](https://attack.mitre.org/techniques/T1496/001) is to validate transactions of cryptocurrency networks and earn virtual currency. Adversaries may consume enough system resources to negatively impact and/or cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus Under The Hood Blog 2017) Servers and cloud-based systems are common targets because of the high potential for available resources, but user endpoint systems may also be compromised and used for [Compute Hijacking](https://attack.mitre.org/techniques/T1496/001) and cryptocurrency mining.(Citation: CloudSploit - Unused AWS Regions) Containerized environments may also be targeted due to the ease of deployment via exposed APIs and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)\\n\\nAdditionally, some cryptocurrency mining malware identify then kill off processes for competing malware to ensure it\\u2019s not competing for resources.(Citation: Trend Micro War of Crypto Miners)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"impact\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1496/001\", \"external_id\": \"T1496.001\"}, {\"source_name\": \"Unit 42 Hildegard Malware\", \"description\": \"Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.\", \"url\": \"https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/\"}, {\"source_name\": \"CloudSploit - Unused AWS Regions\", \"description\": \"CloudSploit. (2019, June 8). The Danger of Unused AWS Regions. Retrieved October 8, 2019.\", \"url\": \"https://medium.com/cloudsploit/the-danger-of-unused-aws-regions-af0bf1b878fc\"}, {\"source_name\": \"Kaspersky Lazarus Under The Hood Blog 2017\", \"description\": \"GReAT. (2017, April 3). Lazarus Under the Hood. Retrieved April 17, 2019.\", \"url\": \"https://securelist.com/lazarus-under-the-hood/77908/\"}, {\"source_name\": \"Trend Micro Exposed Docker APIs\", \"description\": \"Oliveira, A. (2019, May 30). Infected Containers Target Docker via Exposed APIs. Retrieved April 6, 2021.\", \"url\": \"https://www.trendmicro.com/en_us/research/19/e/infected-cryptocurrency-mining-containers-target-docker-hosts-with-exposed-apis-use-shodan-to-find-additional-victims.html\"}, {\"source_name\": \"Trend Micro War of Crypto Miners\", \"description\": \"Oliveira, A., Fiser, D. (2020, September 10). War of Linux Cryptocurrency Miners: A Battle for Resources. Retrieved April 6, 2021.\", \"url\": \"https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Command: Command Execution\", \"Network Traffic: Network Connection Creation\", \"Network Traffic: Network Traffic Content\", \"Network Traffic: Network Traffic Flow\", \"Sensor Health: Host Status\", \"Process: Process Creation\", \"File: File Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_impact_type\": [\"Availability\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\", \"Containers\"], \"x_mitre_version\": \"1.0\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--46c37037-00da-4cf5-bde1-4296e10e6483\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.753Z\", \"modified\": \"2025-04-16T22:11:50.821Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has distributed cryptomining malware.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--a718a0c8-5768-41a1-9958-a1cc3f995e99\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--c726e0a2-a57a-4b7b-a973-d0f013246617\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-16T15:30:57.711Z\", \"modified\": \"2025-04-15T19:59:06.564Z\", \"name\": \"Compile After Delivery\", \"description\": \"Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as ilasm.exe(Citation: ATTACK IQ), csc.exe, or GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018)\\n\\nSource code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [Phishing](https://attack.mitre.org/techniques/T1566). Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.(Citation: TrendMicro WindowsAppMac)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1027/004\", \"external_id\": \"T1027.004\"}, {\"source_name\": \"ClearSky MuddyWater Nov 2018\", \"description\": \"ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018.\", \"url\": \"https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf\"}, {\"source_name\": \"ATTACK IQ\", \"description\": \"Federico Quattrin, Nick Desler, Tin Tam, & Matthew Rutkoske. (2023, March 16). Hiding in Plain Sight: Monitoring and Testing for Living-Off-the-Land Binaries. Retrieved July 15, 2024.\", \"url\": \"https://www.attackiq.com/2023/03/16/hiding-in-plain-sight/\"}, {\"source_name\": \"TrendMicro WindowsAppMac\", \"description\": \"Trend Micro. (2019, February 11). Windows App Runs on Mac, Downloads Info Stealer and Adware. Retrieved April 25, 2019.\", \"url\": \"https://blog.trendmicro.com/trendlabs-security-intelligence/windows-app-runs-on-mac-downloads-info-stealer-and-adware/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Praetorian\", \"Ye Yint Min Thu Htut, Offensive Security Team, DBS Bank\", \"Liran Ravich, CardinalOps\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Creation\", \"Process: Process Creation\", \"File: File Metadata\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor the execution file paths and command-line arguments for common compilers, such as csc.exe and GCC/MinGW, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior. The compilation of payloads may also generate file creation and/or file write events. Look for non-native binary formats and cross-platform compiler and execution frameworks like Mono and determine if they have a legitimate purpose on the system.(Citation: TrendMicro WindowsAppMac) Typically these should only be used in specific and limited cases, like for software development.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--47440b3d-e6ef-4f7d-b732-453d1684424a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.283Z\", \"modified\": \"2025-04-28T15:45:52.694Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has compiled malware, delivered to victims as .c files, with the GNU Compiler Collection (GCC).(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--c726e0a2-a57a-4b7b-a973-d0f013246617\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-13T20:09:59.569Z\", \"modified\": \"2025-04-15T19:58:36.147Z\", \"name\": \"Dynamic Linker Hijacking\", \"description\": \"Adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries. During the execution preparation phase of a program, the dynamic linker loads specified absolute paths of shared libraries from various environment variables and files, such as <code>LD_PRELOAD</code> on Linux or <code>DYLD_INSERT_LIBRARIES</code> on macOS.(Citation: TheEvilBit DYLD_INSERT_LIBRARIES)(Citation: Timac DYLD_INSERT_LIBRARIES)(Citation: Gabilondo DYLD_INSERT_LIBRARIES Catalina Bypass) Libraries specified in environment variables are loaded first, taking precedence over system libraries with the same function name.(Citation: Man LD.SO)(Citation: TLDP Shared Libraries)(Citation: Apple Doco Archive Dynamic Libraries) Each platform's linker uses an extensive list of environment variables at different points in execution. These variables are often used by developers to debug binaries without needing to recompile, deconflict mapped symbols, and implement custom functions in the original library.(Citation: Baeldung LD_PRELOAD)\\n\\nHijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges. On Linux, adversaries may set <code>LD_PRELOAD</code> to point to malicious libraries that match the name of legitimate libraries which are requested by a victim program, causing the operating system to load the adversary's malicious code upon execution of the victim program. For example, adversaries have used `LD_PRELOAD` to inject a malicious library into every descendant process of the `sshd` daemon, resulting in execution under a legitimate process. When the executing sub-process calls the `execve` function, for example, the malicious library\\u2019s `execve` function is executed rather than the system function `execve` contained in the system library on disk. This allows adversaries to [Hide Artifacts](https://attack.mitre.org/techniques/T1564) from detection, as hooking system functions such as `execve` and `readdir` enables malware to scrub its own artifacts from the results of commands such as `ls`, `ldd`, `iptables`, and `dmesg`.(Citation: ESET Ebury Oct 2017)(Citation: Intezer Symbiote 2022)(Citation: Elastic Security Labs Pumakit 2024)\\n\\nHijacking dynamic linker variables may grant access to the victim process's memory, system/network resources, and possibly elevated privileges.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1574/006\", \"external_id\": \"T1574.006\"}, {\"source_name\": \"Apple Doco Archive Dynamic Libraries\", \"description\": \"Apple Inc.. (2012, July 23). Overview of Dynamic Libraries. Retrieved March 24, 2021.\", \"url\": \"https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html\"}, {\"source_name\": \"Baeldung LD_PRELOAD\", \"description\": \"baeldung. (2020, August 9). What Is the LD_PRELOAD Trick?. Retrieved March 24, 2021.\", \"url\": \"https://www.baeldung.com/linux/ld_preload-trick-what-is\"}, {\"source_name\": \"TheEvilBit DYLD_INSERT_LIBRARIES\", \"description\": \"Fitzl, C. (2019, July 9). DYLD_INSERT_LIBRARIES DYLIB injection in macOS / OSX. Retrieved March 26, 2020.\", \"url\": \"https://theevilbit.github.io/posts/dyld_insert_libraries_dylib_injection_in_macos_osx_deep_dive/\"}, {\"source_name\": \"Intezer Symbiote 2022\", \"description\": \"Joakim Kennedy and The BlackBerry Threat Research & Intelligence Team. (2022, June 9). Symbiote Deep-Dive: Analysis of a New, Nearly-Impossible-to-Detect Linux Threat. Retrieved March 24, 2025.\", \"url\": \"https://intezer.com/blog/research/new-linux-threat-symbiote/\"}, {\"source_name\": \"Gabilondo DYLD_INSERT_LIBRARIES Catalina Bypass\", \"description\": \"Jon Gabilondo. (2019, September 22). How to Inject Code into Mach-O Apps. Part II.. Retrieved March 24, 2021.\", \"url\": \"https://jon-gabilondo-angulo-7635.medium.com/how-to-inject-code-into-mach-o-apps-part-ii-ddb13ebc8191\"}, {\"source_name\": \"Man LD.SO\", \"description\": \"Kerrisk, M. (2020, June 13). Linux Programmer's Manual. Retrieved June 15, 2020.\", \"url\": \"https://www.man7.org/linux/man-pages/man8/ld.so.8.html\"}, {\"source_name\": \"Elastic Security Labs Pumakit 2024\", \"description\": \"Remco Sprooten and Ruben Groenewoud. (2024, December 11). Declawing PUMAKIT. Retrieved March 24, 2025.\", \"url\": \"https://www.elastic.co/security-labs/declawing-pumakit\"}, {\"source_name\": \"TLDP Shared Libraries\", \"description\": \"The Linux Documentation Project. (n.d.). Shared Libraries. Retrieved January 31, 2020.\", \"url\": \"https://www.tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\"}, {\"source_name\": \"Timac DYLD_INSERT_LIBRARIES\", \"description\": \"Timac. (2012, December 18). Simple code injection using DYLD_INSERT_LIBRARIES. Retrieved March 26, 2020.\", \"url\": \"https://blog.timac.org/2012/1218-simple-code-injection-using-dyld_insert_libraries/\"}, {\"source_name\": \"ESET Ebury Oct 2017\", \"description\": \"Vachon, F. (2017, October 30). Windigo Still not Windigone: An Ebury Update . Retrieved February 10, 2021.\", \"url\": \"https://www.welivesecurity.com/2017/10/30/windigo-ebury-update-2/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Creation\", \"Command: Command Execution\", \"Module: Module Load\", \"Process: Process Creation\", \"File: File Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for changes to environment variables and files associated with loading shared libraries such as <code>LD_PRELOAD</code> and <code>DYLD_INSERT_LIBRARIES</code>, as well as the commands to implement these changes.\\n\\nMonitor processes for unusual activity (e.g., a process that does not use the network begins to do so). Track library metadata, such as a hash, and compare libraries that are loaded at process execution time against previous executions to detect differences that do not correlate with patching or updates.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\"], \"x_mitre_version\": \"2.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--47b95300-a51c-4d91-9bbe-e40956df2081\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.337Z\", \"modified\": \"2025-04-28T15:45:59.090Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has modified /etc/ld.so.preload to hook libc functions in order to hide the installed dropper and mining software in process lists.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--ec8fc7e2-b356-455c-8db5-2e37be158e7d\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-26T17:46:13.128Z\", \"modified\": \"2025-04-25T14:48:27.868Z\", \"name\": \"Hidden Files and Directories\", \"description\": \"Adversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a \\u2018hidden\\u2019 file. These files don\\u2019t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir /a</code> for Windows and <code>ls \\u2013a</code> for Linux and macOS).\\n\\nOn Linux and Mac, users can mark specific files as hidden simply by putting a \\u201c.\\u201d as the first character in the file or folder name  (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files and folders that start with a period, \\u2018.\\u2019, are by default hidden from being viewed in the Finder application and standard command-line utilities like \\u201cls\\u201d. Users must specifically change settings to have these files viewable.\\n\\nFiles on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app (Citation: WireLurker). On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesn\\u2019t clutter up the user\\u2019s workspace. For example, SSH utilities create a .ssh folder that\\u2019s hidden and contains the user\\u2019s known hosts and keys.\\n\\nAdversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1564/001\", \"external_id\": \"T1564.001\"}, {\"source_name\": \"Sofacy Komplex Trojan\", \"description\": \"Dani Creus, Tyler Halfpop, Robert Falcone. (2016, September 26). Sofacy's 'Komplex' OS X Trojan. Retrieved July 8, 2017.\", \"url\": \"https://researchcenter.paloaltonetworks.com/2016/09/unit42-sofacys-komplex-os-x-trojan/\"}, {\"source_name\": \"Antiquated Mac Malware\", \"description\": \"Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017.\", \"url\": \"https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/\"}, {\"source_name\": \"WireLurker\", \"description\": \"Claud Xiao. (n.d.). WireLurker: A New Era in iOS and OS X Malware. Retrieved July 10, 2017.\", \"url\": \"https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/Unit_42/unit42-wirelurker.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Process: Process Creation\", \"File: File Creation\", \"File: File Metadata\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor the file system and shell commands for files being created with a leading \\\".\\\" and the Windows command-line use of attrib.exe to add the hidden attribute.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"macOS\", \"Linux\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--48141016-3fc6-46af-9f93-b52439ed78ea\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.620Z\", \"modified\": \"2025-04-28T15:46:02.643Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) downloaded a file \\\"libprocesshider\\\", which could hide files on the target system.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--ec8fc7e2-b356-455c-8db5-2e37be158e7d\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2019-12-03T14:25:00.538Z\", \"modified\": \"2025-04-15T19:58:16.429Z\", \"name\": \"Cron\", \"description\": \"Adversaries may abuse the <code>cron</code> utility to perform task scheduling for initial or recurring execution of malicious code.(Citation: 20 macOS Common Tools and Techniques) The <code>cron</code> utility is a time-based job scheduler for Unix-like operating systems.  The <code> crontab</code> file contains the schedule of cron entries to be run and the specified times for execution. Any <code>crontab</code> files are stored in operating system-specific file paths.\\n\\nAn adversary may use <code>cron</code> in Linux or Unix environments to execute programs at system startup or on a scheduled basis for [Persistence](https://attack.mitre.org/tactics/TA0003). In ESXi environments, cron jobs must be created directly via the crontab file (e.g., `/var/spool/cron/crontabs/root`).(Citation: CloudSEK ESXiArgs 2023)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"execution\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1053/003\", \"external_id\": \"T1053.003\"}, {\"source_name\": \"CloudSEK ESXiArgs 2023\", \"description\": \"Mehardeep Singh Sawhney. (2023, February 9). Analysis of Files Used in ESXiArgs Ransomware Attack Against VMware ESXi Servers. Retrieved March 26, 2025.\", \"url\": \"https://www.cloudsek.com/blog/analysis-of-files-used-in-esxiargs-ransomware-attack-against-vmware-esxi-servers\"}, {\"source_name\": \"20 macOS Common Tools and Techniques\", \"description\": \"Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.\", \"url\": \"https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Modification\", \"Process: Process Creation\", \"Scheduled Job: Scheduled Job Creation\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor scheduled task creation from common utilities using command-line invocation. Legitimate scheduled tasks may be created during installation of new software or through system administration functions. Look for changes to tasks that do not correlate with known software, patch cycles, etc.  \\n\\nSuspicious program execution through scheduled tasks may show up as outlier processes that have not been seen before when compared against historical data. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement. \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--49a68076-c596-412d-a8af-3e238dfef960\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.687Z\", \"modified\": \"2025-04-28T15:46:21.063Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) installed a cron job that downloaded and executed files from the C2.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}, {\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-09T14:38:24.334Z\", \"modified\": \"2025-04-15T19:59:08.245Z\", \"name\": \"Python\", \"description\": \"Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables.(Citation: Zscaler APT31 Covid-19 October 2020)\\n\\nPython comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"execution\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1059/006\", \"external_id\": \"T1059.006\"}, {\"source_name\": \"Zscaler APT31 Covid-19 October 2020\", \"description\": \"Singh, S. and Antil, S. (2020, October 27). APT-31 Leverages COVID-19 Vaccine Theme and Abuses Legitimate Online Services. Retrieved March 24, 2021.\", \"url\": \"https://www.zscaler.com/blogs/security-research/apt-31-leverages-covid-19-vaccine-theme-and-abuses-legitimate-online\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Process: Process Creation\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor systems for abnormal Python usage and python.exe behavior, which could be an indicator of malicious activity. Understanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\\n\\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"Windows\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--521c66b9-fe52-4c2b-bc32-8ed3d98c7a71\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.318Z\", \"modified\": \"2025-04-28T15:47:51.677Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used Python-based malware to install and spread their coinminer.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:43.915Z\", \"modified\": \"2025-04-15T19:59:15.945Z\", \"name\": \"Network Service Discovery\", \"description\": \"Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   \\n\\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.\\n\\nWithin macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host\\u2019s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1046\", \"external_id\": \"T1046\"}, {\"source_name\": \"apple doco bonjour description\", \"description\": \"Apple Inc. (2013, April 23). Bonjour Overview. Retrieved October 11, 2021.\", \"url\": \"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/NetServices/Introduction.html\"}, {\"source_name\": \"CISA AR21-126A FIVEHANDS May 2021\", \"description\": \"CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.\", \"url\": \"https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a\"}, {\"source_name\": \"macOS APT Activity Bradley\", \"description\": \"Jaron Bradley. (2021, November 14). What does APT Activity Look Like on macOS?. Retrieved January 19, 2022.\", \"url\": \"https://themittenmac.com/what-does-apt-activity-look-like-on-macos/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Praetorian\", \"Aaron Sullivan aka ZerkerEOD\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Flow\", \"Command: Command Execution\", \"Cloud Service: Cloud Service Enumeration\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nNormal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\", \"Containers\", \"Network Devices\"], \"x_mitre_version\": \"3.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--5d8e9a49-f534-4cb6-9e3e-aebacb3c1dd0\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.683Z\", \"modified\": \"2025-04-28T15:49:58.658Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.(Citation: Talos Rocke August 2018)(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-14T01:27:31.344Z\", \"modified\": \"2025-04-25T14:47:15.984Z\", \"name\": \"Portable Executable Injection\", \"description\": \"Adversaries may inject portable executables (PE) into processes in order to evade process-based defenses as well as possibly elevate privileges. PE injection is a method of executing arbitrary code in the address space of a separate live process. \\n\\nPE injection is commonly performed by copying code (perhaps without a file on disk) into the virtual address space of the target process before invoking it via a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> or additional code (ex: shellcode). The displacement of the injected code does introduce the additional requirement for functionality to remap memory references. (Citation: Elastic Process Injection July 2017) \\n\\nRunning code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via PE injection may also evade detection from security products since the execution is masked under a legitimate process. \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1055/002\", \"external_id\": \"T1055.002\"}, {\"source_name\": \"Elastic Process Injection July 2017\", \"description\": \"Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.\", \"url\": \"https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Process: Process Access\", \"Process: OS API Execution\", \"Process: Process Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such as <code>CreateRemoteThread</code> and those that can be used to modify memory within another process, such as <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, may be used for this technique.(Citation: Elastic Process Injection July 2017)\\n\\nAnalyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior. \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--5de38b67-dbc7-46bf-bb73-91cd0e069d05\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.556Z\", \"modified\": \"2025-04-28T15:50:02.342Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106)'s miner, \\\"TermsHost.exe\\\", evaded defenses by injecting itself into Windows processes, including Notepad.exe.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--f7827069-0bf2-4764-af4f-23fae0d181b7\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-14T22:24:21.841Z\", \"modified\": \"2025-04-25T14:48:36.031Z\", \"name\": \"Dead Drop Resolver\", \"description\": \"Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.\\n\\nPopular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.\\n\\nUse of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1102/001\", \"external_id\": \"T1102.001\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Content\", \"Network Traffic: Network Traffic Flow\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Host data that can relate unknown or suspicious process activity using a network connection is important to supplement any existing indicators of compromise based on malware command and control signatures and infrastructure or the presence of strong encryption. Packet capture analysis will require SSL/TLS inspection if data is encrypted. User behavior monitoring may help to detect abnormal patterns of activity.(Citation: University of Birmingham C2)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"ESXi\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--674031ea-4fff-4669-b44b-d289fa1cc36e\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.542Z\", \"modified\": \"2025-04-28T15:51:44.285Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used Pastebin to check the version of beaconing malware and redirect to another Pastebin hosting updated malware.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--f7827069-0bf2-4764-af4f-23fae0d181b7\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:38.910Z\", \"modified\": \"2025-04-15T19:58:02.121Z\", \"name\": \"Boot or Logon Initialization Scripts\", \"description\": \"Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence.(Citation: Mandiant APT29 Eye Spy Email Nov 22)(Citation: Anomali Rocke March 2019) Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely.  \\n\\nAdversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. \\n\\nAn adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1037\", \"external_id\": \"T1037\"}, {\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}, {\"source_name\": \"Mandiant APT29 Eye Spy Email Nov 22\", \"description\": \"Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.\", \"url\": \"https://www.mandiant.com/resources/blog/unc3524-eye-spy-email\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Modification\", \"Windows Registry: Windows Registry Key Creation\", \"Command: Command Execution\", \"File: File Creation\", \"Process: Process Creation\", \"Active Directory: Active Directory Object Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor logon scripts for unusual access by abnormal users or at abnormal times. Look for files added or modified by unusual accounts outside of normal administration duties. Monitor running process for actions that could be indicative of abnormal programs or executables running upon logon.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"macOS\", \"Windows\", \"Linux\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"2.4\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--6b1cc49f-8d94-4f59-a723-2a70c3edf760\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.430Z\", \"modified\": \"2025-04-28T15:52:28.388Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has installed an \\\"init.d\\\" startup script to maintain persistence.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--deb98323-e13f-4b0c-8d94-175379069062\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-05T14:17:46.686Z\", \"modified\": \"2025-04-16T20:37:22.038Z\", \"name\": \"Software Packing\", \"description\": \"Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.(Citation: ESET FinFisher Jan 2018) \\n\\nUtilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.(Citation: Awesome Executable Packing)  \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1027/002\", \"external_id\": \"T1027.002\"}, {\"source_name\": \"Awesome Executable Packing\", \"description\": \"Alexandre D'Hondt. (n.d.). Awesome Executable Packing. Retrieved March 11, 2022.\", \"url\": \"https://github.com/dhondta/awesome-executable-packing\"}, {\"source_name\": \"ESET FinFisher Jan 2018\", \"description\": \"Kafka, F. (2018, January). ESET's Guide to Deobfuscating and Devirtualizing FinFisher. Retrieved August 12, 2019.\", \"url\": \"https://www.welivesecurity.com/wp-content/uploads/2018/01/WP-FinFisher.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Filip Kafka, ESET\"], \"x_mitre_data_sources\": [\"File: File Metadata\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Use file scanning to look for known software packers or artifacts of packing techniques. Packing is not a definitive indicator of malicious activity, because legitimate software may use packing techniques to reduce binary size or to protect proprietary code.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"macOS\", \"Windows\", \"Linux\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--78fc38f6-88ee-4f26-84e1-7532d95a4fbe\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.550Z\", \"modified\": \"2025-04-28T15:55:13.453Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106)'s miner has created UPX-packed files in the Windows Start Menu Folder.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--deb98323-e13f-4b0c-8d94-175379069062\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}, {\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--2bce5b30-7014-4a5d-ade7-12913fe6ac36\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-28T17:11:54.034Z\", \"modified\": \"2025-04-15T21:56:45.103Z\", \"name\": \"Clear Linux or Mac System Logs\", \"description\": \"Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. The majority of native system logging is stored under the <code>/var/log/</code> directory. Subfolders in this directory categorize logs by their related functions, such as:(Citation: Linux Logs)\\n\\n* <code>/var/log/messages:</code>: General and system-related messages\\n* <code>/var/log/secure</code> or <code>/var/log/auth.log</code>: Authentication logs\\n* <code>/var/log/utmp</code> or <code>/var/log/wtmp</code>: Login records\\n* <code>/var/log/kern.log</code>: Kernel logs\\n* <code>/var/log/cron.log</code>: Crond logs\\n* <code>/var/log/maillog</code>: Mail server logs\\n* <code>/var/log/httpd/</code>: Web server access and error logs\\n\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1070/002\", \"external_id\": \"T1070.002\"}, {\"source_name\": \"Linux Logs\", \"description\": \"Marcel. (2018, April 19). 12 Critical Linux Log Files You Must be Monitoring. Retrieved March 29, 2020.\", \"url\": \"https://www.eurovps.com/blog/important-linux-log-files-you-must-be-monitoring/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Deletion\", \"File: File Modification\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"File system monitoring may be used to detect improper deletion or modification of indicator files. Also monitor for suspicious processes interacting with log files.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\"], \"x_mitre_version\": \"1.0\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--93b62fc4-f024-4482-9ea1-041bc3d29bfd\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.230Z\", \"modified\": \"2025-04-28T16:00:12.374Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has cleared log files within the /var/log/ folder.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--2bce5b30-7014-4a5d-ade7-12913fe6ac36\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-23T22:02:48.566Z\", \"modified\": \"2025-04-15T19:58:54.099Z\", \"name\": \"Registry Run Keys / Startup Folder\", \"description\": \"Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \\\"run keys\\\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.(Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\\n\\nThe following run keys are created by default on Windows systems:\\n\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code>\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce</code>\\n* <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</code>\\n* <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce</code>\\n\\nRun keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.(Citation: Microsoft Run Key) For example, it is possible to load a DLL at logon using a \\\"Depend\\\" key with RunOnceEx: <code>reg add HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\\\\0001\\\\Depend /v 1 /d \\\"C:\\\\temp\\\\evil[.]dll\\\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\\n\\nPlacing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\\\Users\\\\\\\\[Username]\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup</code>. The startup folder path for all users is <code>C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\StartUp</code>.\\n\\nThe following Registry keys can be used to set startup folder items for persistence:\\n\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders</code>\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders</code>\\n* <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders</code>\\n* <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders</code>\\n\\nThe following Registry keys can control automatic startup of services during boot:\\n\\n* <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServicesOnce</code>\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServicesOnce</code>\\n* <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices</code>\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices</code>\\n\\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\\n\\n* <code>HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run</code>\\n* <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run</code>\\n\\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows</code> run automatically for the currently logged-on user.\\n\\nBy default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\\n\\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1547/001\", \"external_id\": \"T1547.001\"}, {\"source_name\": \"Malwarebytes Wow6432Node 2016\", \"description\": \"Arntz, P. (2016, March 30). Hiding in Plain Sight. Retrieved August 3, 2020.\", \"url\": \"https://blog.malwarebytes.com/cybercrime/2013/10/hiding-in-plain-sight/\"}, {\"source_name\": \"Microsoft Wow6432Node 2018\", \"description\": \"Microsoft. (2018, May 31). 32-bit and 64-bit Application Data in the Registry. Retrieved August 3, 2020.\", \"url\": \"https://docs.microsoft.com/en-us/windows/win32/sysinfo/32-bit-and-64-bit-application-data-in-the-registry\"}, {\"source_name\": \"Microsoft Run Key\", \"description\": \"Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved September 12, 2024.\", \"url\": \"https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys\"}, {\"source_name\": \"Oddvar Moe RunOnceEx Mar 2018\", \"description\": \"Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018.\", \"url\": \"https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/\"}, {\"source_name\": \"TechNet Autoruns\", \"description\": \"Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.\", \"url\": \"https://technet.microsoft.com/en-us/sysinternals/bb963902\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Oddvar Moe, @oddvarmoe\", \"Dray Agha, @Purp1eW0lf, Huntress Labs\", \"Harun K\\u00fc\\u00dfner\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Modification\", \"Process: Process Creation\", \"Windows Registry: Windows Registry Key Creation\", \"Windows Registry: Windows Registry Key Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Monitor the start folder for additions or changes. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations and startup folders. (Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.\\n\\nChanges to these locations typically happen under normal conditions when legitimate software is installed. To increase confidence of malicious activity, data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"2.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--a1956344-1a2d-4193-bb20-0f65c98776fe\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.607Z\", \"modified\": \"2025-04-28T16:02:53.028Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106)'s miner has created UPX-packed files in the Windows Start Menu Folder.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--09b130a2-a77e-4af0-a361-f46f9aad1345\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-04T19:24:27.774Z\", \"modified\": \"2025-04-15T22:46:00.944Z\", \"name\": \"Linux and Mac File and Directory Permissions Modification\", \"description\": \"Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 May 2018) File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.).\\n\\nMost Linux and Linux-based platforms provide a standard set of permission groups (user, group, and other) and a standard set of permissions (read, write, and execute) that are applied to each group. While nuances of each platform\\u2019s permissions implementation may vary, most of the platforms provide two primary commands used to manipulate file and directory ACLs: <code>chown</code> (short for change owner), and <code>chmod</code> (short for change mode).\\n\\nAdversarial may use these commands to make themselves the owner of files and directories or change the mode if current permissions allow it. They could subsequently lock others out of the file. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via [Unix Shell Configuration Modification](https://attack.mitre.org/techniques/T1546/004) or tainting/hijacking other instrumental binary/configuration files via [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).(Citation: 20 macOS Common Tools and Techniques) \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1222/002\", \"external_id\": \"T1222.002\"}, {\"source_name\": \"Hybrid Analysis Icacls1 June 2018\", \"description\": \"Hybrid Analysis. (2018, June 12). c9b65b764985dfd7a11d3faf599c56b8.exe. Retrieved August 19, 2018.\", \"url\": \"https://www.hybrid-analysis.com/sample/ef0d2628823e8e0a0de3b08b8eacaf41cf284c086a948bdfd67f4e4373c14e4d?environmentId=100\"}, {\"source_name\": \"Hybrid Analysis Icacls2 May 2018\", \"description\": \"Hybrid Analysis. (2018, May 30). 2a8efbfadd798f6111340f7c1c956bee.dll. Retrieved August 19, 2018.\", \"url\": \"https://www.hybrid-analysis.com/sample/22dab012c3e20e3d9291bce14a2bfc448036d3b966c6e78167f4626f5f9e38d6?environmentId=110\"}, {\"source_name\": \"20 macOS Common Tools and Techniques\", \"description\": \"Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.\", \"url\": \"https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Process: Process Creation\", \"File: File Metadata\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor and investigate attempts to modify ACLs and file/directory ownership. Many of the commands used to modify ACLs and file/directory ownership are built-in system utilities and may generate a high false positive alert rate, so compare against baseline knowledge for how systems are typically used and correlate modification events with other indications of malicious activity where possible. Commonly abused command arguments include <code>chmod +x</code>, <code>chmod -R 755</code>, and <code>chmod 777</code>.(Citation: 20 macOS Common Tools and Techniques) \\n\\nConsider enabling file/directory permission change auditing on folders containing key binary/configuration files.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"macOS\", \"Linux\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--a2f88508-4177-4294-b287-6a3494f6e738\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.476Z\", \"modified\": \"2025-04-28T16:03:06.646Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has changed file permissions of files so they could not be modified.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--09b130a2-a77e-4af0-a361-f46f9aad1345\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:48.728Z\", \"modified\": \"2025-04-15T19:58:50.607Z\", \"name\": \"Process Discovery\", \"description\": \"Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\\n\\nIn Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via `/proc`. ESXi also supports use of the `ps` command, as well as `esxcli system process list`.(Citation: Sygnia ESXi Ransomware 2025)(Citation: Crowdstrike Hypervisor Jackpotting Pt 2 2021)\\n\\nOn network devices, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `show processes` can be used to display current running processes.(Citation: US-CERT-TA18-106A)(Citation: show_processes_cisco_cmd)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1057\", \"external_id\": \"T1057\"}, {\"source_name\": \"show_processes_cisco_cmd\", \"description\": \"Cisco. (2022, August 16). show processes - . Retrieved July 13, 2022.\", \"url\": \"https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/command/cf_command_ref/show_monitor_permit_list_through_show_process_memory.html#wp3599497760\"}, {\"source_name\": \"Crowdstrike Hypervisor Jackpotting Pt 2 2021\", \"description\": \"Michael Dawson. (2021, August 30). Hypervisor Jackpotting, Part 2: eCrime Actors Increase Targeting of ESXi Servers with Ransomware. Retrieved March 26, 2025.\", \"url\": \"https://www.crowdstrike.com/en-us/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/\"}, {\"source_name\": \"US-CERT-TA18-106A\", \"description\": \"US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-106A\"}, {\"source_name\": \"Sygnia ESXi Ransomware 2025\", \"description\": \"Zhongyuan Hau (Aaron), Ren Jie Yow, and Yoav Mazor. (2025, January 21). ESXi Ransomware Attacks: Stealthy Persistence through. Retrieved March 27, 2025.\", \"url\": \"https://www.sygnia.co/blog/esxi-ransomware-ssh-tunneling-defense-strategies/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Process: Process Creation\", \"Process: OS API Execution\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nNormal, benign system and network events that look like process discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nFor network infrastructure devices, collect AAA logging to monitor for `show` commands being run by non-standard users from non-standard locations.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"Network Devices\", \"Windows\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--a3d2ef4a-2bca-482d-897b-99da14b16b52\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.484Z\", \"modified\": \"2025-04-28T16:03:16.142Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) can detect a running process's PID on the infected machine.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-17T16:15:19.870Z\", \"modified\": \"2025-04-15T19:59:14.487Z\", \"name\": \"Systemd Service\", \"description\": \"Adversaries may create or modify systemd services to repeatedly execute malicious payloads as part of persistence. Systemd is a system and service manager commonly used for managing background daemon processes (also known as services) and other system resources.(Citation: Linux man-pages: systemd January 2014) Systemd is the default initialization (init) system on many Linux distributions replacing legacy init systems, including SysVinit and Upstart, while remaining backwards compatible.  \\n\\nSystemd utilizes unit configuration files with the `.service` file extension to encode information about a service's process. By default, system level unit files are stored in the `/systemd/system` directory of the root owned directories (`/`). User level unit files are stored in the `/systemd/user` directories of the user owned directories (`$HOME`).(Citation: lambert systemd 2022) \\n\\nInside the `.service` unit files, the following directives are used to execute commands:(Citation: freedesktop systemd.service)  \\n\\n* `ExecStart`, `ExecStartPre`, and `ExecStartPost` directives execute when a service is started manually by `systemctl` or on system start if the service is set to automatically start.\\n* `ExecReload` directive executes when a service restarts. \\n* `ExecStop`, `ExecStopPre`, and `ExecStopPost` directives execute when a service is stopped.  \\n\\nAdversaries have created new service files, altered the commands a `.service` file\\u2019s directive executes, and modified the user directive a `.service` file executes as, which could result in privilege escalation. Adversaries may also place symbolic links in these directories, enabling systemd to find these payloads regardless of where they reside on the filesystem.(Citation: Anomali Rocke March 2019)(Citation: airwalk backdoor unix systems)(Citation: Rapid7 Service Persistence 22JUNE2016) \\n\\nThe `.service` file\\u2019s User directive can be used to run service as a specific user, which could result in privilege escalation based on specific user/group permissions. \\n\\nSystemd services can be created via systemd generators, which support the dynamic generation of unit files. Systemd generators are small executables that run during boot or configuration reloads to dynamically create or modify systemd unit files by converting non-native configurations into services, symlinks, or drop-ins (i.e., [Boot or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037)).(Citation: Elastic Security Labs Linux Persistence 2024)(Citation: Pepe Berba Systemd 2022)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1543/002\", \"external_id\": \"T1543.002\"}, {\"source_name\": \"airwalk backdoor unix systems\", \"description\": \"airwalk. (2023, January 1). A guide to backdooring Unix systems. Retrieved May 31, 2023.\", \"url\": \"http://www.ouah.org/backdoors.html\"}, {\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}, {\"source_name\": \"freedesktop systemd.service\", \"description\": \"Free Desktop. (n.d.). systemd.service \\u2014 Service unit configuration. Retrieved March 20, 2023.\", \"url\": \"https://www.freedesktop.org/software/systemd/man/systemd.service.html\"}, {\"source_name\": \"Linux man-pages: systemd January 2014\", \"description\": \"Linux man-pages. (2014, January). systemd(1) - Linux manual page. Retrieved April 23, 2019.\", \"url\": \"http://man7.org/linux/man-pages/man1/systemd.1.html\"}, {\"source_name\": \"Pepe Berba Systemd 2022\", \"description\": \"Pepe Berba. (2022, February 7). Hunting for Persistence in Linux (Part 5): Systemd Generators. Retrieved April 8, 2025.\", \"url\": \"https://pberba.github.io/security/2022/02/07/linux-threat-hunting-for-persistence-systemd-generators/\"}, {\"source_name\": \"Berba hunting linux systemd\", \"description\": \"Pepe Berba. (2022, January 30). Hunting for Persistence in Linux (Part 3): Systemd, Timers, and Cron. Retrieved March 20, 2023.\", \"url\": \"https://pberba.github.io/security/2022/01/30/linux-threat-hunting-for-persistence-systemd-timers-cron/\"}, {\"source_name\": \"Rapid7 Service Persistence 22JUNE2016\", \"description\": \"Rapid7. (2016, June 22). Service Persistence. Retrieved April 23, 2019.\", \"url\": \"https://www.rapid7.com/db/modules/exploit/linux/local/service_persistence\"}, {\"source_name\": \"Elastic Security Labs Linux Persistence 2024\", \"description\": \"Ruben Groenewoud. (2024, August 20). Linux Detection Engineering -  A primer on persistence mechanisms. Retrieved March 18, 2025.\", \"url\": \"https://www.elastic.co/security-labs/primer-on-persistence-mechanisms\"}, {\"source_name\": \"lambert systemd 2022\", \"description\": \"Tony Lambert. (2022, November 13). ATT&CK T1501: Understanding systemd service persistence. Retrieved March 20, 2023.\", \"url\": \"https://redcanary.com/blog/attck-t1501-understanding-systemd-service-persistence/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Tony Lambert, Red Canary\", \"Emad Al-Mousa, Saudi Aramco\", \"Tim (Wadhwa-)Brown\", \"Ruben Groenewoud (@RFGroenewoud)\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Modification\", \"Service: Service Creation\", \"Service: Service Modification\", \"Process: Process Creation\", \"File: File Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor file creation and modification events of Systemd service unit configuration files in the default directory locations for `root` & `user` level permissions. Suspicious processes or scripts spawned in this manner will have a parent process of \\u2018systemd\\u2019, a parent process ID of 1, and will usually execute as the `root` user.(Citation: lambert systemd 2022) \\n\\nSuspicious systemd services can also be identified by comparing results against a trusted system baseline. Malicious systemd services may be detected by using the systemctl utility to examine system wide services: `systemctl list-units -\\u2013type=service \\u2013all`. Analyze the contents of `.service` files present on the file system and ensure that they refer to legitimate, expected executables, and symbolic links.(Citation: Berba hunting linux systemd)\\n\\nAuditing the execution and command-line arguments of the `systemctl` utility, as well related utilities such as `/usr/sbin/service` may reveal malicious systemd service execution.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\"], \"x_mitre_version\": \"1.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--a430e3fa-bfc0-4ea8-8264-217f6aa015fc\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.416Z\", \"modified\": \"2025-04-28T16:03:19.223Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has installed a systemd service script to maintain persistence.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:28.187Z\", \"modified\": \"2025-04-15T19:59:15.859Z\", \"name\": \"Remote System Discovery\", \"description\": \"Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\\n\\nAdversaries may also analyze data from local host files (ex: <code>C:\\\\Windows\\\\System32\\\\Drivers\\\\etc\\\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\\n\\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \\n\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1018\", \"external_id\": \"T1018\"}, {\"source_name\": \"CISA AR21-126A FIVEHANDS May 2021\", \"description\": \"CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.\", \"url\": \"https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a\"}, {\"source_name\": \"Elastic - Koadiac Detection with EQL\", \"description\": \"Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 17, 2024.\", \"url\": \"https://www.elastic.co/security-labs/embracing-offensive-tooling-building-detections-against-koadic-using-eql\"}, {\"source_name\": \"US-CERT-TA18-106A\", \"description\": \"US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-106A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Daniel Stepanic, Elastic\", \"RedHuntLabs, @redhuntlabs\", \"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Access\", \"Network Traffic: Network Connection Creation\", \"Process: Process Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nMonitor for processes that can be used to discover remote systems, such as <code>ping.exe</code> and <code>tracert.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"3.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--beae1b73-f369-4443-8e59-eb9e99665e8d\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.610Z\", \"modified\": \"2025-04-28T16:07:57.669Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.(Citation: Talos Rocke August 2018)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-12-14T16:46:06.044Z\", \"modified\": \"2025-04-15T19:58:24.400Z\", \"name\": \"Deobfuscate/Decode Files or Information\", \"description\": \"Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system.\\n\\nOne such example is the use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file.(Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> or <code>type</code> command to reassemble binary fragments into a malicious payload.(Citation: Carbon Black Obfuscation Sept 2016)(Citation: Sentinel One Tainted Love 2023)\\n\\nSometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.(Citation: Volexity PowerDuke November 2016)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1140\", \"external_id\": \"T1140\"}, {\"source_name\": \"Volexity PowerDuke November 2016\", \"description\": \"Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.\", \"url\": \"https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/\"}, {\"source_name\": \"Sentinel One Tainted Love 2023\", \"description\": \"Aleksandar Milenkoski, Juan Andres Guerrero-Saade, and Joey Chen. (2023, March 23). Operation Tainted Love | Chinese APTs Target Telcos in New Attacks. Retrieved March 18, 2025.\", \"url\": \"https://www.sentinelone.com/labs/operation-tainted-love-chinese-apts-target-telcos-in-new-attacks/\"}, {\"source_name\": \"Malwarebytes Targeted Attack against Saudi Arabia\", \"description\": \"Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017.\", \"url\": \"https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/\"}, {\"source_name\": \"Carbon Black Obfuscation Sept 2016\", \"description\": \"Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018.\", \"url\": \"https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Matthew Demaske, Adaptforward\", \"Red Canary\", \"Crist\\u00f3bal Mart\\u00ednez Mart\\u00edn\"], \"x_mitre_data_sources\": [\"Process: Process Creation\", \"Script: Script Execution\", \"File: File Modification\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Detecting the action of deobfuscating or decoding files or information may be difficult depending on the implementation. If the functionality is contained within malware and uses the Windows API, then attempting to detect malicious behavior before or after the action may yield better results than attempting to perform analysis on loaded libraries or API calls. If scripts are used, then collecting the scripts for analysis may be necessary. Perform process and command-line monitoring to detect potentially malicious behavior related to scripts and system utilities such as [certutil](https://attack.mitre.org/software/S0160).\\n\\nMonitor the execution file paths and command-line arguments for common archive file applications and extensions, such as those for Zip and RAR archive tools, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"ESXi\", \"Linux\", \"Windows\", \"macOS\"], \"x_mitre_version\": \"1.4\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--c8fdab57-1e10-4f66-a1de-59a876c99ab1\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.352Z\", \"modified\": \"2025-04-28T16:09:54.158Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has extracted tar.gz files after downloading them from a C2 server.(Citation: Talos Rocke August 2018)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--ac08589e-ee59-4935-8667-d845e38fe579\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-21T20:32:20.810Z\", \"modified\": \"2025-04-15T19:58:57.147Z\", \"name\": \"Disable or Modify Tools\", \"description\": \"Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information. Adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems.(Citation: SCADAfence_ransomware)\\n\\nAdversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls) Alternatively, they may add new directories to an endpoint detection and response (EDR) tool\\u2019s exclusion list, enabling them to hide malicious files via [File/Path Exclusions](https://attack.mitre.org/techniques/T1564/012).(Citation: BlackBerry WhisperGate 2022)(Citation: Google Cloud Threat Intelligence FIN13 2021)\\n\\nAdversaries may also focus on specific applications such as Sysmon. For example, the \\u201cStart\\u201d and \\u201cEnable\\u201d values in <code>HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\Autologger\\\\EventLog-Microsoft-Windows-Sysmon-Operational</code> may be modified to tamper with and potentially disable Sysmon logging.(Citation: disable_win_evt_logging) \\n\\nOn network devices, adversaries may attempt to skip digital signature verification checks by altering startup configuration files and effectively disabling firmware verification that typically occurs at boot.(Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation)(Citation: Analysis of FG-IR-22-369)\\n\\nIn cloud environments, tools disabled by adversaries may include cloud monitoring agents that report back to services such as AWS CloudWatch or Google Cloud Monitor.\\n\\nFurthermore, although defensive tools may have anti-tampering mechanisms, adversaries may abuse tools such as legitimate rootkit removal kits to impair and/or disable these tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) For example, adversaries have used tools such as GMER to find and shut down hidden processes and antivirus software on infected systems.(Citation: demystifying_ryuk)\\n\\nAdditionally, adversaries may exploit legitimate drivers from anti-virus software to gain access to kernel space (i.e. [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)), which may lead to bypassing anti-tampering features.(Citation: avoslocker_ransomware)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1562/001\", \"external_id\": \"T1562.001\"}, {\"source_name\": \"Analysis of FG-IR-22-369\", \"description\": \" Guillaume Lovet and Alex Kong. (2023, March 9). Analysis of FG-IR-22-369. Retrieved May 15, 2023.\", \"url\": \"https://www.fortinet.com/blog/psirt-blogs/fg-ir-22-369-psirt-analysis\"}, {\"source_name\": \"Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation\", \"description\": \"ALEXANDER MARVI, BRAD SLAYBAUGH, DAN EBREO, TUFAIL AHMED, MUHAMMAD UMAIR, TINA JOHNSON. (2023, March 16). Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation. Retrieved May 15, 2023.\", \"url\": \"https://www.mandiant.com/resources/blog/fortinet-malware-ecosystem\"}, {\"source_name\": \"BlackBerry WhisperGate 2022\", \"description\": \"BlackBerry Research and Intelligence Team. (2022, February 3). Threat Spotlight: WhisperGate Wiper Wreaks Havoc in Ukraine. Retrieved March 18, 2025.\", \"url\": \"https://blogs.blackberry.com/en/2022/02/threat-spotlight-whispergate-wiper-wreaks-havoc-in-ukraine\"}, {\"source_name\": \"OutFlank System Calls\", \"description\": \"de Plaa, C. (2019, June 19). Red Team Tactics: Combining Direct System Calls and sRDI to bypass AV/EDR. Retrieved September 29, 2021.\", \"url\": \"https://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/\"}, {\"source_name\": \"disable_win_evt_logging\", \"description\": \"Heiligenstein, L. (n.d.). REP-25: Disable Windows Event Logging. Retrieved April 7, 2022.\", \"url\": \"https://ptylu.github.io/content/report/report.html?report=25\"}, {\"source_name\": \"chasing_avaddon_ransomware\", \"description\": \"Hernandez, A. S. Tarter, P. Ocamp, E. J. (2022, January 19). One Source to Rule Them All: Chasing AVADDON Ransomware. Retrieved January 26, 2022.\", \"url\": \"https://www.mandiant.com/resources/chasing-avaddon-ransomware\"}, {\"source_name\": \"doppelpaymer_crowdstrike\", \"description\": \"Hurley, S. (2021, December 7). Critical Hit: How DoppelPaymer Hunts and Kills Windows Processes. Retrieved January 26, 2022.\", \"url\": \"https://www.crowdstrike.com/blog/how-doppelpaymer-hunts-and-kills-windows-processes/\"}, {\"source_name\": \"avoslocker_ransomware\", \"description\": \"Lakshmanan, R. (2022, May 2). AvosLocker Ransomware Variant Using New Trick to Disable Antivirus Protection. Retrieved May 17, 2022.\", \"url\": \"https://thehackernews.com/2022/05/avoslocker-ransomware-variant-using-new.html\"}, {\"source_name\": \"dharma_ransomware\", \"description\": \"Loui, E. Scheuerman, K. et al. (2020, April 16). Targeted Dharma Ransomware Intrusions Exhibit Consistent Techniques. Retrieved January 26, 2022.\", \"url\": \"https://www.crowdstrike.com/blog/targeted-dharma-ransomware-intrusions-exhibit-consistent-techniques/\"}, {\"source_name\": \"MDSec System Calls\", \"description\": \"MDSec Research. (2020, December). Bypassing User-Mode Hooks and Direct Invocation of System Calls for Red Teams. Retrieved September 29, 2021.\", \"url\": \"https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/\"}, {\"source_name\": \"SCADAfence_ransomware\", \"description\": \"Shaked, O. (2020, January 20). Anatomy of a Targeted Ransomware Attack. Retrieved June 18, 2022.\", \"url\": \"https://cdn.logic-control.com/docs/scadafence/Anatomy-Of-A-Targeted-Ransomware-Attack-WP.pdf\"}, {\"source_name\": \"demystifying_ryuk\", \"description\": \"Tran, T. (2020, November 24). Demystifying Ransomware Attacks Against Microsoft Defender Solution. Retrieved January 26, 2022.\", \"url\": \"https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/demystifying-ransomware-attacks-against-microsoft-defender/ba-p/1928947\"}, {\"source_name\": \"Google Cloud Threat Intelligence FIN13 2021\", \"description\": \"Van Ta, Jake Nicastro, Rufus Brown, and Nick Richard. (2021, December 7). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved March 18, 2025.\", \"url\": \"https://cloud.google.com/blog/topics/threat-intelligence/fin13-cybercriminal-mexico/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Gordon Long, Box, Inc., @ethicalhax\", \"Ziv Karliner, @ziv_kr, Team Nautilus Aqua Security\", \"Nathaniel Quist, Palo Alto Networks\", \"Gal Singer, @galsinger29, Team Nautilus Aqua Security\", \"Daniel Feichter, @VirtualAllocEx, Infosec Tirol\", \"Cian Heasley\", \"Alex Soler, AttackIQ\", \"Sarathkumar Rajendran, Microsoft Defender365\", \"Lucas Heiligenstein\", \"Menachem Goldstein\"], \"x_mitre_data_sources\": [\"Sensor Health: Host Status\", \"Process: Process Termination\", \"Process: Process Creation\", \"Service: Service Metadata\", \"Windows Registry: Windows Registry Key Modification\", \"Command: Command Execution\", \"Windows Registry: Windows Registry Key Deletion\", \"Driver: Driver Load\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor processes and command-line arguments to see if security tools/services are killed or stop running. Monitor Registry edits for modifications to services and startup programs that correspond to security tools. Monitoring for changes to other known features used by deployed security tools may also expose malicious activity.\\n\\nLack of expected log events may be suspicious.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"macOS\", \"Linux\", \"Containers\", \"IaaS\", \"Network Devices\"], \"x_mitre_version\": \"1.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--ca1afca5-2f16-497e-bfff-1564706e05f2\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.626Z\", \"modified\": \"2025-04-28T16:10:06.813Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) used scripts which detected and uninstalled antivirus software.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--ac08589e-ee59-4935-8667-d845e38fe579\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--60b508a1-6a5e-46b1-821a-9f7b78752abf\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-04T13:06:49.258Z\", \"modified\": \"2025-04-15T19:58:35.201Z\", \"name\": \"Private Keys\", \"description\": \"Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. \\n\\nAdversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. Adversary tools may also search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia)\\n\\nWhen a device is registered to Entra ID, a device key and a transport key are generated and used to verify the device\\u2019s identity.(Citation: Microsoft Primary Refresh Token) An adversary with access to the device may be able to export the keys in order to impersonate the device.(Citation: AADInternals Azure AD Device Identities)\\n\\nOn network devices, private keys may be exported via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `crypto pki export`.(Citation: cisco_deploy_rsa_keys) \\n\\nSome private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1552/004\", \"external_id\": \"T1552.004\"}, {\"source_name\": \"Palo Alto Prince of Persia\", \"description\": \"Bar, T., Conant, S., Efraim, L. (2016, June 28). Prince of Persia \\u2013 Game Over. Retrieved July 5, 2017.\", \"url\": \"https://researchcenter.paloaltonetworks.com/2016/06/unit42-prince-of-persia-game-over/\"}, {\"source_name\": \"cisco_deploy_rsa_keys\", \"description\": \"Cisco. (2023, February 17). Chapter: Deploying RSA Keys Within a PKI . Retrieved March 27, 2023.\", \"url\": \"https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/sec_conn_pki/configuration/xe-17/sec-pki-xe-17-book/sec-deploy-rsa-pki.html#GUID-1CB802D8-9DE3-447F-BECE-CF22F5E11436\"}, {\"source_name\": \"AADInternals Azure AD Device Identities\", \"description\": \"Dr. Nestori Syynimaa. (2022, February 15). Stealing and faking Azure AD device identities. Retrieved February 21, 2023.\", \"url\": \"https://aadinternals.com/post/deviceidentity/\"}, {\"source_name\": \"Kaspersky Careto\", \"description\": \"Kaspersky Labs. (2014, February 11). Unveiling \\u201cCareto\\u201d - The Masked APT. Retrieved July 5, 2017.\", \"url\": \"https://web.archive.org/web/20141031134104/http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/unveilingthemask_v1.0.pdf\"}, {\"source_name\": \"Microsoft Primary Refresh Token\", \"description\": \"Microsoft. (2022, September 9). What is a Primary Refresh Token?. Retrieved February 21, 2023.\", \"url\": \"https://learn.microsoft.com/en-us/azure/active-directory/devices/concept-primary-refresh-token\"}, {\"source_name\": \"Wikipedia Public Key Crypto\", \"description\": \"Wikipedia. (2017, June 29). Public-key cryptography. Retrieved July 5, 2017.\", \"url\": \"https://en.wikipedia.org/wiki/Public-key_cryptography\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Itzik Kotler, SafeBreach\", \"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Access\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor access to files and directories related to cryptographic keys and certificates as a means for potentially detecting access patterns that may indicate collection and exfiltration activity. Collect authentication logs and look for potentially abnormal activity that may indicate improper use of keys or certificates for remote authentication. For network infrastructure devices, collect AAA logging to monitor for private keys being exported.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--de8fefef-bfe7-4720-a443-66713a47b439\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.241Z\", \"modified\": \"2025-04-28T16:13:40.838Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used SSH private keys on the infected machine to spread its coinminer throughout a network.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--60b508a1-6a5e-46b1-821a-9f7b78752abf\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-31T12:35:36.479Z\", \"modified\": \"2025-04-15T19:59:12.733Z\", \"name\": \"File Deletion\", \"description\": \"Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary (ex: [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\\n\\nThere are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well.(Citation: Microsoft SDelete July 2016) Examples of built-in [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) functions include <code>del</code> on Windows, <code>rm</code> or <code>unlink</code> on Linux and macOS, and `rm` on ESXi.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1070/004\", \"external_id\": \"T1070.004\"}, {\"source_name\": \"Microsoft SDelete July 2016\", \"description\": \"Russinovich, M. (2016, July 4). SDelete v2.0. Retrieved February 8, 2018.\", \"url\": \"https://docs.microsoft.com/en-us/sysinternals/downloads/sdelete\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Walker Johnson\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Deletion\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"It may be uncommon for events related to benign command-line functions such as DEL or third-party utilities or tools to be found in an environment, depending on the user base and how systems are typically used. Monitoring for command-line deletion functions to correlate with binaries or other files that an adversary may drop and remove may lead to detection of malicious activity. Another good practice is monitoring for known deletion and secure deletion tools that are not already on systems within an enterprise network that an adversary could introduce. Some monitoring tools may collect command-line arguments, but may not capture DEL commands since DEL is a native function within cmd.exe.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"ESXi\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--dec705fd-139b-49d6-b0d8-888b2b922a12\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.535Z\", \"modified\": \"2025-04-28T16:13:42.582Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has deleted files on infected machines.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-15T16:13:46.151Z\", \"modified\": \"2025-04-15T19:59:14.227Z\", \"name\": \"Web Protocols\", \"description\": \"Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nProtocols such as HTTP/S(Citation: CrowdStrike Putter Panda) and WebSocket(Citation: Brazking-Websockets) that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1071/001\", \"external_id\": \"T1071.001\"}, {\"source_name\": \"CrowdStrike Putter Panda\", \"description\": \"Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.\", \"url\": \"http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}, {\"source_name\": \"Brazking-Websockets\", \"description\": \"Shahar Tavor. (n.d.). BrazKing Android Malware Upgraded and Targeting Brazilian Banks. Retrieved March 24, 2023.\", \"url\": \"https://securityintelligence.com/posts/brazking-android-malware-upgraded-targeting-brazilian-banks/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"TruKno\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Content\", \"Network Traffic: Network Traffic Flow\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\\n\\nMonitor for web traffic to/from known-bad or suspicious domains. \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"1.4\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--e8095f70-12de-4330-a293-25c4b4f22ffc\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.685Z\", \"modified\": \"2025-04-28T16:15:16.698Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has executed wget and curl commands to Pastebin over the HTTPS protocol.(Citation: Anomali Rocke March 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--b18eae87-b469-4e14-b454-b171b416bc18\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-14T18:18:32.443Z\", \"modified\": \"2025-04-15T19:58:58.463Z\", \"name\": \"Non-Standard Port\", \"description\": \"Adversaries may communicate using a protocol and port pairing that are typically not associated. For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.\\n\\nAdversaries may also make changes to victim systems to abuse non-standard ports. For example, Registry keys and other configuration settings can be used to modify protocol and port pairings.(Citation: change_rdp_port_conti)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"command-and-control\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1571\", \"external_id\": \"T1571\"}, {\"source_name\": \"University of Birmingham C2\", \"description\": \"Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.\", \"url\": \"https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf\"}, {\"source_name\": \"Symantec Elfin Mar 2019\", \"description\": \"Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/elfin-apt33-espionage\"}, {\"source_name\": \"change_rdp_port_conti\", \"description\": \"The DFIR Report. (2022, March 1). \\\"Change RDP port\\\" #ContiLeaks. Retrieved September 12, 2024.\", \"url\": \"https://x.com/TheDFIRReport/status/1498657772254240768\"}, {\"source_name\": \"Fortinet Agent Tesla April 2018\", \"description\": \"Zhang, X. (2018, April 05). Analysis of New Agent Tesla Spyware Variant. Retrieved November 5, 2018.\", \"url\": \"https://www.fortinet.com/blog/threat-research/analysis-of-new-agent-tesla-spyware-variant.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Flow\", \"Network Traffic: Network Traffic Content\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.(Citation: University of Birmingham C2)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"ESXi\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--f7f947cd-6e0c-499c-8cdf-293e38657e31\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.411Z\", \"modified\": \"2025-04-28T16:17:59.466Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106)'s miner connects to a C2 server using port 51640.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--b18eae87-b469-4e14-b454-b171b416bc18\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-11T18:27:15.774Z\", \"modified\": \"2025-04-15T19:58:17.607Z\", \"name\": \"SSH\", \"description\": \"Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user.\\n\\nSSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. On ESXi, SSH can be enabled either directly on the host (e.g., via `vim-cmd hostsvc/enable_ssh`) or via vCenter.(Citation: Sygnia ESXi Ransomware 2025)(Citation: TrendMicro ESXI Ransomware)(Citation: Sygnia Abyss Locker 2025) The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user\\u2019s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user (i.e., [SSH Authorized Keys](https://attack.mitre.org/techniques/T1098/004)).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"lateral-movement\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1021/004\", \"external_id\": \"T1021.004\"}, {\"source_name\": \"Sygnia Abyss Locker 2025\", \"description\": \"Abigail See, Zhongyuan (Aaron) Hau, Ren Jie Yow, Yoav Mazor, Omer Kidron, and Oren Biderman. (2025, February 4). The Anatomy of Abyss Locker Ransomware Attack. Retrieved April 4, 2025.\", \"url\": \"https://www.sygnia.co/blog/abyss-locker-ransomware-attack-analysis/\"}, {\"source_name\": \"TrendMicro ESXI Ransomware\", \"description\": \"Junestherry Dela Cruz. (2022, January 24). Analysis and Impact of LockBit Ransomware\\u2019s First Linux and VMware ESXi Variant. Retrieved March 26, 2025.\", \"url\": \"https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html\"}, {\"source_name\": \"Apple Unified Log Analysis Remote Login and Screen Sharing\", \"description\": \"Sarah Edwards. (2020, April 30). Analysis of Apple Unified Logs: Quarantine Edition [Entry 6] \\u2013 Working From Home? Remote Logins. Retrieved August 19, 2021.\", \"url\": \"https://sarah-edwards-xzkc.squarespace.com/blog/2020/4/30/analysis-of-apple-unified-logs-quarantine-edition-entry-6-working-from-home-remote-logins\"}, {\"source_name\": \"Sygnia ESXi Ransomware 2025\", \"description\": \"Zhongyuan Hau (Aaron), Ren Jie Yow, and Yoav Mazor. (2025, January 21). ESXi Ransomware Attacks: Stealthy Persistence through. Retrieved March 27, 2025.\", \"url\": \"https://www.sygnia.co/blog/esxi-ransomware-ssh-tunneling-defense-strategies/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Janantha Marasinghe\"], \"x_mitre_data_sources\": [\"Logon Session: Logon Session Creation\", \"Process: Process Creation\", \"Network Traffic: Network Connection Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Use of SSH may be legitimate depending on the environment and how it\\u2019s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.\\n\\nOn macOS systems <code>log show --predicate 'process = \\\"sshd\\\"'</code> can be used to review incoming SSH connection attempts for suspicious activity. The command <code>log show --info --predicate 'process = \\\"ssh\\\" or eventMessage contains \\\"ssh\\\"'</code> can be used to review outgoing SSH connection activity.(Citation: Apple Unified Log Analysis Remote Login and Screen Sharing)\\n\\nOn Linux systems SSH activity can be found in the logs located in <code>/var/log/auth.log</code> or <code>/var/log/secure</code> depending on the distro you are using.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--fa69ac7a-8031-4fac-91e2-65e90f378cd1\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.273Z\", \"modified\": \"2025-04-28T16:18:22.576Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has spread its coinminer via SSH.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--47f2d673-ca62-47e9-929b-1b0be9657611\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-31T12:42:44.103Z\", \"modified\": \"2025-04-15T19:58:27.752Z\", \"name\": \"Timestomp\", \"description\": \"Adversaries may modify file time attributes to hide new files or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder and blend malicious files with legitimate files.\\n\\nIn Windows systems, both the `$STANDARD_INFORMATION` (`$SI`) and `$FILE_NAME` (`$FN`) attributes record times in a Master File Table (MFT) file.(Citation: Inversecos Timestomping 2022) `$SI` (dates/time stamps) is displayed to the end user, including in the File System view, while `$FN` is dealt with by the kernel.(Citation: Magnet Forensics)\\n\\nModifying the `$SI` attribute is the most common method of timestomping because it can be modified at the user level using API calls. `$FN` timestomping, however, typically requires interacting with the system kernel or moving or renaming a file.(Citation: Inversecos Timestomping 2022)\\n\\nAdversaries modify timestamps on files so that they do not appear conspicuous to forensic investigators or file analysis tools. In order to evade detections that rely on identifying discrepancies between the `$SI` and `$FN` attributes, adversaries may also engage in \\u201cdouble timestomping\\u201d by modifying times on both attributes simultaneously.(Citation: Double Timestomping)\\n\\nIn Linux systems and on ESXi servers, threat actors may attempt to perform timestomping using commands such as `touch -a -m -t <timestamp> <filename>` (which sets access and modification times to a specific value) or `touch -r <filename> <filename>` (which sets access and modification times to match those of another file).(Citation: Inversecos Linux Timestomping)(Citation: Juniper Networks ESXi Backdoor 2022)\\n\\nTimestomping may be used along with file name [Masquerading](https://attack.mitre.org/techniques/T1036) to hide malware and tools.(Citation: WindowsIR Anti-Forensic Techniques)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1070/006\", \"external_id\": \"T1070.006\"}, {\"source_name\": \"Juniper Networks ESXi Backdoor 2022\", \"description\": \"Asher Langton. (2022, December 9). A Custom Python Backdoor for VMWare ESXi Servers. Retrieved March 26, 2025.\", \"url\": \"https://blogs.juniper.net/en-us/threat-research/a-custom-python-backdoor-for-vmware-esxi-servers\"}, {\"source_name\": \"WindowsIR Anti-Forensic Techniques\", \"description\": \"Carvey, H. (2013, July 23). HowTo: Determine/Detect the use of Anti-Forensics Techniques. Retrieved June 3, 2016.\", \"url\": \"http://windowsir.blogspot.com/2013/07/howto-determinedetect-use-of-anti.html\"}, {\"source_name\": \"Inversecos Linux Timestomping\", \"description\": \"inversecos. (2022, August 4). Detecting Linux Anti-Forensics: Timestomping. Retrieved March 26, 2025.\", \"url\": \"https://www.inversecos.com/2022/08/detecting-linux-anti-forensics.html\"}, {\"source_name\": \"Inversecos Timestomping 2022\", \"description\": \"Lina Lau. (2022, April 28). Defence Evasion Technique: Timestomping Detection \\u2013 NTFS Forensics. Retrieved September 30, 2024.\", \"url\": \"https://www.inversecos.com/2022/04/defence-evasion-technique-timestomping.html\"}, {\"source_name\": \"Magnet Forensics\", \"description\": \"Magnet Forensics. (2020, August 24). Expose Evidence of Timestomping with the NTFS Timestamp Mismatch Artifact. Retrieved June 20, 2024.\", \"url\": \"https://www.magnetforensics.com/blog/expose-evidence-of-timestomping-with-the-ntfs-timestamp-mismatch-artifact-in-magnet-axiom-4-4/\"}, {\"source_name\": \"Double Timestomping\", \"description\": \"Matthew Dunwoody. (2022, April 28). I have seen double-timestomping ITW, including by APT29. Stay sharp out there.. Retrieved June 20, 2024.\", \"url\": \"https://x.com/matthewdunwoody/status/1519846657646604289\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Romain Dumont, ESET\", \"Mike Hartley @mikehartley10\"], \"x_mitre_data_sources\": [\"Process: OS API Execution\", \"File: File Modification\", \"File: File Metadata\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Forensic techniques exist to detect aspects of files that have had their timestamps modified. (Citation: WindowsIR Anti-Forensic Techniques) It may be possible to detect timestomping using file modification monitoring that collects information on file handle opens and can compare timestamp values.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"ESXi\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--ff14431c-bf82-44be-b12a-a65e88d5347a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.473Z\", \"modified\": \"2025-04-28T16:19:14.154Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has changed the time stamp of certain files.(Citation: Anomali Rocke March 2019)\\t\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--47f2d673-ca62-47e9-929b-1b0be9657611\", \"external_references\": [{\"source_name\": \"Anomali Rocke March 2019\", \"description\": \"Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.\", \"url\": \"https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--1c4e5d32-1fe9-4116-9d9d-59e3925bd6a2\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-10T20:43:10.239Z\", \"modified\": \"2025-04-15T19:58:11.443Z\", \"name\": \"Match Legitimate Resource Name or Location\", \"description\": \"Adversaries may match or approximate the name or location of legitimate files, Registry keys, or other resources when naming/placing them. This is done for the sake of evading defenses and observation. \\n\\nThis may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: `svchost.exe`). Alternatively, a Windows Registry key may be given a close approximation to a key used by a legitimate program. In containerized environments, a threat actor may create a resource in a trusted namespace or one that matches the naming convention of a container pod or cluster.(Citation: Aquasec Kubernetes Backdoor 2023)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1036/005\", \"external_id\": \"T1036.005\"}, {\"source_name\": \"Twitter ItsReallyNick Masquerading Update\", \"description\": \"Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved September 12, 2024.\", \"url\": \"https://x.com/ItsReallyNick/status/1055321652777619457\"}, {\"source_name\": \"Docker Images\", \"description\": \"Docker. (n.d.). Docker Images. Retrieved April 6, 2021.\", \"url\": \"https://docs.docker.com/engine/reference/commandline/images/\"}, {\"source_name\": \"Elastic Masquerade Ball\", \"description\": \"Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.\", \"url\": \"https://www.elastic.co/blog/how-hunt-masquerade-ball\"}, {\"source_name\": \"Aquasec Kubernetes Backdoor 2023\", \"description\": \"Michael Katchinskiy and Assaf Morag. (2023, April 21). First-Ever Attack Leveraging Kubernetes RBAC to Backdoor Clusters. Retrieved March 24, 2025.\", \"url\": \"https://www.aquasec.com/blog/leveraging-kubernetes-rbac-to-backdoor-clusters/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Yossi Weizman, Azure Defender Research Team\", \"Vishwas Manral, McAfee\"], \"x_mitre_data_sources\": [\"File: File Metadata\", \"Image: Image Metadata\", \"Process: Process Metadata\", \"Process: Process Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Collect file hashes; file names that do not match their expected hash are suspect. Perform file monitoring; files with known names but in unusual locations are suspect. Likewise, files that are modified outside of an update or patch are suspect.\\n\\nIf file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)\\n\\nIn containerized environments, use image IDs and layer hashes to compare images instead of relying only on their names.(Citation: Docker Images) Monitor for the unexpected creation of new resources within your cluster in Kubernetes, especially those created by atypical users.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Containers\", \"ESXi\"], \"x_mitre_version\": \"2.0\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--ff438715-ffa8-4fa2-a69e-7126dd60bfb3\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-11T19:52:07.350Z\", \"modified\": \"2025-04-28T16:19:16.269Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) has used shell scripts which download mining executables and saves them with the filename \\\"java\\\".(Citation: Talos Rocke August 2018)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--1c4e5d32-1fe9-4116-9d9d-59e3925bd6a2\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--cba37adb-d6fb-4610-b069-dd04c0643384\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-21T21:16:18.066Z\", \"modified\": \"2025-04-15T23:05:09.449Z\", \"name\": \"Security Software Discovery\", \"description\": \"Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\\n\\nExample commands that can be used to obtain security software information are [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> with [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> with [cmd](https://attack.mitre.org/software/S0106), and [Tasklist](https://attack.mitre.org/software/S0057), but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.\\n\\nAdversaries may also utilize the [Cloud API](https://attack.mitre.org/techniques/T1059/009) to discover cloud-native security software installed on compute infrastructure, such as the AWS CloudWatch agent, Azure VM Agent, and Google Cloud Monitor agent. These agents  may collect  metrics and logs from the VM, which may be centrally aggregated in a cloud-based monitoring platform.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1518/001\", \"external_id\": \"T1518.001\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Isif Ibrahima, Mandiant\"], \"x_mitre_data_sources\": [\"Process: Process Creation\", \"Firewall: Firewall Metadata\", \"Command: Command Execution\", \"Process: OS API Execution\", \"Firewall: Firewall Enumeration\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained.\\n\\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nIn cloud environments, additionally monitor logs for the usage of APIs that may be used to gather information about security software configurations within the environment.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\"], \"x_mitre_version\": \"1.5\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--ffb03265-d9d6-4dc7-ba8e-71498be4e131\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-05-26T16:17:59.670Z\", \"modified\": \"2025-04-28T16:19:21.549Z\", \"relationship_type\": \"uses\", \"description\": \"[Rocke](https://attack.mitre.org/groups/G0106) used scripts which detected and uninstalled antivirus software.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)\", \"source_ref\": \"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad\", \"target_ref\": \"attack-pattern--cba37adb-d6fb-4610-b069-dd04c0643384\", \"external_references\": [{\"source_name\": \"Talos Rocke August 2018\", \"description\": \"Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.\", \"url\": \"https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html\"}, {\"source_name\": \"Unit 42 Rocke January 2019\", \"description\": \"Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.\", \"url\": \"https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}], "software": [], "actor_techniques_software_map": {}, "actor_techniques_to_tactics_map": {"TA0001": ["attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"], "TA0002": ["attack-pattern--a9d4b653-6915-42af-98b2-5758c4ceee56", "attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c", "attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1"], "TA0003": ["attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825", "attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c", "attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334", "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b"], "TA0004": ["attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825", "attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c", "attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662", "attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334", "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279", "attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b"], "TA0005": ["attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b", "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", "attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b", "attack-pattern--c726e0a2-a57a-4b7b-a973-d0f013246617", "attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825", "attack-pattern--ec8fc7e2-b356-455c-8db5-2e37be158e7d", "attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662", "attack-pattern--deb98323-e13f-4b0c-8d94-175379069062", "attack-pattern--2bce5b30-7014-4a5d-ade7-12913fe6ac36", "attack-pattern--09b130a2-a77e-4af0-a361-f46f9aad1345", "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c", "attack-pattern--ac08589e-ee59-4935-8667-d845e38fe579", "attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c", "attack-pattern--47f2d673-ca62-47e9-929b-1b0be9657611", "attack-pattern--1c4e5d32-1fe9-4116-9d9d-59e3925bd6a2"], "TA0006": ["attack-pattern--60b508a1-6a5e-46b1-821a-9f7b78752abf"], "TA0007": ["attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1", "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88", "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580", "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735", "attack-pattern--cba37adb-d6fb-4610-b069-dd04c0643384"], "TA0008": ["attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6"], "TA0011": ["attack-pattern--830c9528-df21-472c-8c14-a036bf17d665", "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6", "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", "attack-pattern--f7827069-0bf2-4764-af4f-23fae0d181b7", "attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161", "attack-pattern--b18eae87-b469-4e14-b454-b171b416bc18"], "TA0040": ["attack-pattern--a718a0c8-5768-41a1-9958-a1cc3f995e99"]}, "indicators": {"intrusion-set--44102191-3a31-45f8-acbe-34bdb441d5ad": [{"type": "bundle", "id": "bundle--5d563b1d-9d6d-4b42-a4c4-4ecb6c89d8d9", "objects": [{"type": "indicator", "spec_version": "2.1", "id": "indicator--00c3e6ae-5aa7-4d6e-b4b8-52779a2e5bdb", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Malicious IPv4 addresses used by Rocke", "pattern_type": "stix", "pattern": "[ipv4-addr:value IN ('118.24.150.172','123.249.9.149','52.167.219.168','120.55.226.24','27.193.180.224','112.226.250.77','27.210.170.197','112.226.74.162','93.174.93.149')]", "valid_from": "2018-07-30T00:00:00Z", "description": "Command-and-control and scanning infrastructure observed in Rocke cryptomining campaigns"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--5a948be8-7f62-41f8-aa30-1fcc5a5cb4c4", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Malicious domains used by Rocke", "pattern_type": "stix", "pattern": "[domain-name:value IN ('sydwzl.cn','blockbitcoin.com','dazqc4f140wtl.cloudfront.net','d20blzxlz9ydha.cloudfront.net','3g2upl4pq6kufc4m.tk','d3goboxon32grk2l.tk','enjoytopic.tk','realtimenews.tk','8282.space','3389.space','5-xun.com','88180585.com','firstomato.com','jxtiewei.com','ncyypx.net','xmr.pool.minergate.com','blog.sydwzl.cn')]", "valid_from": "2018-07-30T00:00:00Z", "description": "Domains leveraged for payload hosting, C2, or mining pool connections by Rocke"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--f5efb67e-3d7a-4db1-927c-8998b34668b4", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Malicious URLs delivering Rocke payloads", "pattern_type": "stix", "pattern": "[url:value IN ('http://d20blzxlz9ydha.cloudfront.net/INSTALL.EXE','http://93.174.93.149/.XXXZLOL.TAR.GZ','https://gitee.com/c-999/ss/raw/master/ss/a','https://gitee.com/c-888/ss/raw/master/ss/cron.d','https://gitlab.com/c-18/ss/raw/master/ss/x')]", "valid_from": "2018-07-30T00:00:00Z", "description": "Representative set of URLs observed distributing Rocke shell scripts or miners"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--c05fef4a-a9f6-4ce7-8e98-c8f7abc6c7ab", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Malicious file hashes \u2013 Rocke miners, scripts and configs (SHA-256)", "pattern_type": "stix", "pattern": "[file:hashes.'SHA-256' IN ('55dbdb84c40d9dc8c5aaf83226ca00a3395292cc8f884bdc523a44c2fd431c7b','38066751cb6c39691904ffbe86fe3bdfa737e4ba64add4dd90358245fa2b775','89b3463664ff13ea77256094844c9cf69d3e408d3daf9ffad3aa18af39bab410','d341e3a9133e534ca35d5ccc54b8a79f93ff0c917790e7d5f73fedaa480a6b93','442e4a8d35f9de21d5cbd9a695a24b9ac8120e548119c7f9f881ee16ad3761e6','7674e0b69d848e0b9ff8b82df8671f9889f33ab1a664f299bcce13744e08954c','7051c9af966d1c55a4096e2af2e6670d4fc75e00b2b396921a79549fb16d03d4','7c2dbc0d74e01a5e7c13b4a41d3a1f7564c165bd532e4473acea6f46405d0889','d44e767132d68fdb07c23c848ff8c28efe19d1b7c070161b7bd6c0ccfc858750','35cb971daafd368b71ad843a4e0b81c80225ec20d7679cfbf78e628ebcada542','654ec27ea99c44edc03f1f3971d2a898b9f1441de156832d1507590a47b41190','f808a42b10cf55603389945a549ce45edc6a04562196d14f7489af04688f12bc','725efd0f5310763bc5375e7b72dbb2e883ad90ec32d6177c578a1c04c1b62054','d7fbd2a4db44d86b4cf5fa4202203dacfefd6ffca6a0615dca5bc2a200ad56b6','ece3cfdb75aaabc570bf38af6f4653f73101c1641ce78a4bb146e62d9ac0cd50','ad68ab153623472bbd8220fb19c488ae2884d9b52bc65add5d54b1821b4b743a','45ed59d5b27d22567d91a65623d3b7f11726f55b497c383bc2d8d330e5e17161','7fe9d6d8b9390020862ca7dc9e69c1e2b676db5898e4bfad51d66250e9af3eaf')]", "valid_from": "2018-07-30T00:00:00Z", "description": "Known Rocke payloads (ELF/PE miners, shell scripts, configs, embedded executables)"}]}]}}