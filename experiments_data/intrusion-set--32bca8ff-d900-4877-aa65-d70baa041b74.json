{"actor": {"id": "intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74", "name": "Leafminer", "created": "2018-10-17T00:14:20.652Z", "modified": "2023-03-22T04:50:51.782Z", "x_mitre_version": "2.4", "type": "intrusion-set", "aliases": ["Leafminer", "Raspite"], "x_mitre_contributors": [], "revoked": false, "description": null, "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_deprecated": false, "x_mitre_attack_spec_version": "3.1.0", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "x_mitre_domains": ["enterprise-attack"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "external_references": [{"source_name": "Raspite", "url": "", "external_id": "", "description": "(Citation: Dragos Raspite Aug 2018)"}, {"source_name": "Leafminer", "url": "", "external_id": "", "description": "(Citation: Symantec Leafminer July 2018)"}, {"source_name": "Dragos Raspite Aug 2018", "url": "https://www.dragos.com/blog/20180802Raspite.html", "external_id": "", "description": "Dragos, Inc. (2018, August 2). RASPITE. Retrieved November 26, 2018."}, {"source_name": "Symantec Leafminer July 2018", "url": "https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east", "external_id": "", "description": "Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018."}], "names": ["Leafminer", "Flash Kitten", "Raspite"], "external_tools": ["Sorgu", "guester / Trojan.Imecab"], "country": "iran", "operations": [], "links": ["https://www.dragos.com/blog/20180802Raspite.html", "https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east", "https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/"], "targets": ["MENA Region"], "external_description": [], "attck_id": "G0077", "comment": "long-running SWC campaigns from December 2016 until public disclosure in July 2018"}, "techniques": [{"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--d511a6f6-4a33-41d5-bc95-c343875d1377\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2023-03-14T17:36:01.022Z\", \"modified\": \"2025-04-15T22:06:13.992Z\", \"name\": \"Command Obfuscation\", \"description\": \"Adversaries may obfuscate content during command execution to impede detection. Command-line obfuscation is a method of making strings and patterns within commands and scripts more difficult to signature and analyze. This type of obfuscation can be included within commands executed by delivered payloads (e.g., [Phishing](https://attack.mitre.org/techniques/T1566) and [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)) or interactively via [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059).(Citation: Akamai JS)(Citation: Malware Monday VBE)\\n\\nFor example, adversaries may abuse syntax that utilizes various symbols and escape characters (such as spacing,  `^`, `+`. `$`, and `%`) to make commands difficult to analyze while maintaining the same intended functionality.(Citation: RC PowerShell) Many languages support built-in obfuscation in the form of base64 or URL encoding.(Citation: Microsoft PowerShellB64) Adversaries may also manually implement command obfuscation via string splitting (`\\u201cWor\\u201d+\\u201cd.Application\\u201d`), order and casing of characters (`rev <<<'dwssap/cte/ tac'`), globing (`mkdir -p '/tmp/:&$NiA'`), as well as various tricks involving passing strings through tokens/environment variables/input streams.(Citation: Bashfuscator Command Obfuscators)(Citation: FireEye Obfuscation June 2017)\\n\\nAdversaries may also use tricks such as directory traversals to obfuscate references to the binary being invoked by a command (`C:\\\\voi\\\\pcw\\\\..\\\\..\\\\Windows\\\\tei\\\\qs\\\\k\\\\..\\\\..\\\\..\\\\system32\\\\erool\\\\..\\\\wbem\\\\wg\\\\je\\\\..\\\\..\\\\wmic.exe shadowcopy delete`).(Citation: Twitter Richard WMIC)\\n\\nTools such as <code>Invoke-Obfuscation</code> and <code>Invoke-DOSfucation</code> have also been used to obfuscate commands.(Citation: Invoke-DOSfuscation)(Citation: Invoke-Obfuscation)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1027/010\", \"external_id\": \"T1027.010\"}, {\"source_name\": \"Twitter Richard WMIC\", \"description\": \"Ackroyd, R. (2023, March 24). Twitter. Retrieved September 12, 2024.\", \"url\": \"https://x.com/rfackroyd/status/1639136000755765254\"}, {\"source_name\": \"Invoke-Obfuscation\", \"description\": \"Bohannon, D. (2016, September 24). Invoke-Obfuscation. Retrieved March 17, 2023.\", \"url\": \"https://github.com/danielbohannon/Invoke-Obfuscation\"}, {\"source_name\": \"Invoke-DOSfuscation\", \"description\": \"Bohannon, D. (2018, March 19). Invoke-DOSfuscation. Retrieved March 17, 2023.\", \"url\": \"https://github.com/danielbohannon/Invoke-DOSfuscation\"}, {\"source_name\": \"FireEye Obfuscation June 2017\", \"description\": \"Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018.\", \"url\": \"https://web.archive.org/web/20170923102302/https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html\"}, {\"source_name\": \"Malware Monday VBE\", \"description\": \"Bromiley, M. (2016, December 27). Malware Monday: VBScript and VBE Files. Retrieved March 17, 2023.\", \"url\": \"https://bromiley.medium.com/malware-monday-vbscript-and-vbe-files-292252c1a16\"}, {\"source_name\": \"Akamai JS\", \"description\": \"Katz, O. (2020, October 26). Catch Me if You Can\\u2014JavaScript Obfuscation. Retrieved March 17, 2023.\", \"url\": \"https://www.akamai.com/blog/security/catch-me-if-you-can-javascript-obfuscation\"}, {\"source_name\": \"Bashfuscator Command Obfuscators\", \"description\": \"LeFevre, A. (n.d.). Bashfuscator Command Obfuscators. Retrieved March 17, 2023.\", \"url\": \"https://bashfuscator.readthedocs.io/en/latest/Mutators/command_obfuscators/index.html\"}, {\"source_name\": \"Microsoft PowerShellB64\", \"description\": \"Microsoft. (2023, February 8). about_PowerShell_exe: EncodedCommand. Retrieved March 17, 2023.\", \"url\": \"https://learn.microsoft.com/powershell/module/microsoft.powershell.core/about/about_powershell_exe?view=powershell-5.1#-encodedcommand-base64encodedcommand\"}, {\"source_name\": \"RC PowerShell\", \"description\": \"Red Canary. (n.d.). 2022 Threat Detection Report: PowerShell. Retrieved March 17, 2023.\", \"url\": \"https://redcanary.com/threat-detection-report/techniques/powershell/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"TruKno\", \"Tim Peck\", \"George Thomas\"], \"x_mitre_data_sources\": [\"File: File Metadata\", \"Script: Script Execution\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\"], \"x_mitre_version\": \"1.0\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--0eb683e1-bd09-4572-866a-f178ce54f7b6\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-16T21:56:33.495Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) obfuscated scripts that were used on victim machines.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--d511a6f6-4a33-41d5-bc95-c343875d1377\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-10-01T02:08:33.977Z\", \"modified\": \"2025-04-15T23:16:21.007Z\", \"name\": \"Tool\", \"description\": \"Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as [Cobalt Strike](https://attack.mitre.org/software/S0154). Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.(Citation: Recorded Future Beacon 2019)\\n\\nAdversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"resource-development\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1588/002\", \"external_id\": \"T1588.002\"}, {\"source_name\": \"Analyzing CS Dec 2020\", \"description\": \"Maynier, E. (2020, December 20). Analyzing Cobalt Strike for Fun and Profit. Retrieved October 12, 2021.\", \"url\": \"https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/\"}, {\"source_name\": \"Recorded Future Beacon 2019\", \"description\": \"Recorded Future. (2019, June 20). Out of the Blue: How Recorded Future Identified Rogue Cobalt Strike Servers. Retrieved September 16, 2024.\", \"url\": \"https://www.recordedfuture.com/blog/identifying-cobalt-strike-servers\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"SOCCRATES\", \"Mnemonic AS\"], \"x_mitre_data_sources\": [\"Malware Repository: Malware Metadata\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"In some cases, malware repositories can also be used to identify features of tool use associated with an adversary, such as watermarks in [Cobalt Strike](https://attack.mitre.org/software/S0154) payloads.(Citation: Analyzing CS Dec 2020)\\n\\nMuch of this activity will take place outside the visibility of the target organization, making detection of this behavior difficult. Detection efforts may be focused on post-compromise phases of the adversary lifecycle.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"PRE\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--1e902f51-efe0-4848-b47a-7e1a1664b101\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2021-10-12T19:25:56.921Z\", \"modified\": \"2025-04-28T15:38:21.295Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) has obtained and used tools such as [LaZagne](https://attack.mitre.org/software/S0349), [Mimikatz](https://attack.mitre.org/software/S0002), [PsExec](https://attack.mitre.org/software/S0029), and [MailSniper](https://attack.mitre.org/software/S0413).(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-11T18:41:44.783Z\", \"modified\": \"2025-04-15T22:45:12.834Z\", \"name\": \"LSASS Memory\", \"description\": \"Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\\n\\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\\n\\nFor example, on the target host use procdump:\\n\\n* <code>procdump -ma lsass.exe lsass_dump</code>\\n\\nLocally, mimikatz can be run using:\\n\\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\\n* <code>sekurlsa::logonPasswords</code>\\n\\nBuilt-in Windows tools such as `comsvcs.dll` can also be used:\\n\\n* <code>rundll32.exe C:\\\\Windows\\\\System32\\\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\\n\\nSimilar to [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012), the silent process exit mechanism can be abused to create a memory dump of `lsass.exe` through Windows Error Reporting (`WerFault.exe`).(Citation: Deep Instinct LSASS)\\n\\nWindows Security Support Provider (SSP) DLLs are loaded into LSASS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\Security Packages</code> and <code>HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\OSConfig\\\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\\n\\nThe following SSPs can be used to access credentials:\\n\\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\\n\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1003/001\", \"external_id\": \"T1003.001\"}, {\"source_name\": \"Medium Detecting Attempts to Steal Passwords from Memory\", \"description\": \"French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.\", \"url\": \"https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea\"}, {\"source_name\": \"Deep Instinct LSASS\", \"description\": \"Gilboa, A. (2021, February 16). LSASS Memory Dumps are Stealthier than Ever Before - Part 2. Retrieved December 27, 2023.\", \"url\": \"https://www.deepinstinct.com/blog/lsass-memory-dumps-are-stealthier-than-ever-before-part-2\"}, {\"source_name\": \"Graeber 2014\", \"description\": \"Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.\", \"url\": \"http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html\"}, {\"source_name\": \"Volexity Exchange Marauder March 2021\", \"description\": \"Gruzweig, J. et al. (2021, March 2). Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities. Retrieved March 3, 2021.\", \"url\": \"https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/\"}, {\"source_name\": \"Powersploit\", \"description\": \"PowerSploit. (n.d.). Retrieved December 4, 2014.\", \"url\": \"https://github.com/mattifestation/PowerSploit\"}, {\"source_name\": \"Symantec Attacks Against Government Sector\", \"description\": \"Symantec. (2021, June 10). Attacks Against the Government Sector. Retrieved September 28, 2021.\", \"url\": \"https://symantec.broadcom.com/hubfs/Attacks-Against-Government-Sector.pdf\"}, {\"source_name\": \"TechNet Blogs Credential Protection\", \"description\": \"Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018.\", \"url\": \"https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Edward Millington\", \"Ed Williams, Trustwave, SpiderLabs\", \"Olaf Hartong, Falcon Force\", \"Michael Forret, Quorum Cyber\"], \"x_mitre_data_sources\": [\"Process: Process Access\", \"Windows Registry: Windows Registry Key Modification\", \"Process: Process Creation\", \"Process: OS API Execution\", \"Logon Session: Logon Session Creation\", \"Command: Command Execution\", \"File: File Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for unexpected processes interacting with LSASS.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as Mimikatz access LSASS.exe by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.\\n\\nOn Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.\\n\\nMonitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.5\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--21198a81-0fa4-4114-9a75-478e7212b87a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T15:38:54.336Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne and Mimikatz.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-11T18:48:28.456Z\", \"modified\": \"2025-04-15T22:12:11.343Z\", \"name\": \"Credentials from Password Stores\", \"description\": \"Adversaries may search for common password storage locations to obtain user credentials.(Citation: F-Secure The Dukes) Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications and services that store passwords to make them easier for users to manage and maintain, such as password managers and cloud secrets vaults. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1555\", \"external_id\": \"T1555\"}, {\"source_name\": \"F-Secure The Dukes\", \"description\": \"F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.\", \"url\": \"https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Access\", \"Command: Command Execution\", \"Process: Process Access\", \"Cloud Service: Cloud Service Enumeration\", \"Process: Process Creation\", \"Process: OS API Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor system calls, file read events, and processes for suspicious activity that could indicate searching for a password  or other activity related to performing keyword searches (e.g. password, pwd, login, store, secure, credentials, etc.) in process memory for credentials. File read events should be monitored surrounding known password storage applications.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"IaaS\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--3d116ef6-d11b-4d04-9bf8-c51def11bd3b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-19T23:18:35.453Z\", \"modified\": \"2025-04-28T15:43:58.978Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:43.915Z\", \"modified\": \"2025-04-15T19:59:15.945Z\", \"name\": \"Network Service Discovery\", \"description\": \"Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system.(Citation: CISA AR21-126A FIVEHANDS May 2021)   \\n\\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.\\n\\nWithin macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a host\\u2019s registered services on the network. For example, adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>) to find other systems broadcasting the ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1046\", \"external_id\": \"T1046\"}, {\"source_name\": \"apple doco bonjour description\", \"description\": \"Apple Inc. (2013, April 23). Bonjour Overview. Retrieved October 11, 2021.\", \"url\": \"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/NetServices/Introduction.html\"}, {\"source_name\": \"CISA AR21-126A FIVEHANDS May 2021\", \"description\": \"CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.\", \"url\": \"https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a\"}, {\"source_name\": \"macOS APT Activity Bradley\", \"description\": \"Jaron Bradley. (2021, November 14). What does APT Activity Look Like on macOS?. Retrieved January 19, 2022.\", \"url\": \"https://themittenmac.com/what-does-apt-activity-look-like-on-macos/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Praetorian\", \"Aaron Sullivan aka ZerkerEOD\"], \"x_mitre_data_sources\": [\"Network Traffic: Network Traffic Flow\", \"Command: Command Execution\", \"Cloud Service: Cloud Service Enumeration\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nNormal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\", \"Containers\", \"Network Devices\"], \"x_mitre_version\": \"3.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--4258ffdf-ecdb-465d-af16-bda97062ab7f\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T15:45:01.357Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) scanned network services to search for vulnerabilities in the victim system.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-21T15:42:25.991Z\", \"modified\": \"2025-04-15T21:55:45.923Z\", \"name\": \"Cached Domain Credentials\", \"description\": \"Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds)\\n\\nOn Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache)\\n\\nOn Linux systems, Active Directory credentials can be accessed through caches maintained by software like System Security Services Daemon (SSSD) or Quest Authentication Services (formerly VAS). Cached credential hashes are typically located at `/var/lib/sss/db/cache.[domain].ldb` for SSSD or `/var/opt/quest/vas/authcache/vas_auth.vdb` for Quest. Adversaries can use utilities, such as `tdbdump`, on these database files to dump the cached hashes and use [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to obtain the plaintext password.(Citation: Brining MimiKatz to Unix) \\n\\nWith SYSTEM or sudo access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py for Windows or Linikatz for Linux can be used to extract the cached credentials.(Citation: Brining MimiKatz to Unix)\\n\\nNote: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1003/005\", \"external_id\": \"T1003.005\"}, {\"source_name\": \"PassLib mscache\", \"description\": \"Eli Collins. (2016, November 25). Windows' Domain Cached Credentials v2. Retrieved February 21, 2020.\", \"url\": \"https://passlib.readthedocs.io/en/stable/lib/passlib.hash.msdcc2.html\"}, {\"source_name\": \"ired mscache\", \"description\": \"Mantvydas Baranauskas. (2019, November 16). Dumping and Cracking mscash - Cached Domain Credentials. Retrieved February 21, 2020.\", \"url\": \"https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials\"}, {\"source_name\": \"Microsoft - Cached Creds\", \"description\": \"Microsoft. (2016, August 21). Cached and Stored Credentials Technical Overview. Retrieved February 21, 2020.\", \"url\": \"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh994565(v%3Dws.11)\"}, {\"source_name\": \"Powersploit\", \"description\": \"PowerSploit. (n.d.). Retrieved December 4, 2014.\", \"url\": \"https://github.com/mattifestation/PowerSploit\"}, {\"source_name\": \"Brining MimiKatz to Unix\", \"description\": \"Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.\", \"url\": \"https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Ed Williams, Trustwave, SpiderLabs\", \"Tim (Wadhwa-)Brown\", \"Yves Yonan\"], \"x_mitre_data_sources\": [\"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\\n\\nDetection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"Linux\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--59a6ccad-02c1-4794-ac65-4d01c8ca7a3f\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-19T23:18:35.449Z\", \"modified\": \"2025-04-28T15:49:12.733Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-12T18:57:36.041Z\", \"modified\": \"2025-04-15T22:12:28.087Z\", \"name\": \"Credentials from Web Browsers\", \"description\": \"Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\\n\\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim\\u2019s cached logon credentials as the decryption key.(Citation: Microsoft CryptUnprotectData April 2018)\\n \\nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\\n\\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\\n\\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1555/003\", \"external_id\": \"T1555.003\"}, {\"source_name\": \"GitHub Mimikittenz July 2016\", \"description\": \"Jamieson O'Reilly (putterpanda). (2016, July 4). mimikittenz. Retrieved June 20, 2019.\", \"url\": \"https://github.com/putterpanda/mimikittenz\"}, {\"source_name\": \"Talos Olympic Destroyer 2018\", \"description\": \"Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.\", \"url\": \"https://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"}, {\"source_name\": \"Microsoft CryptUnprotectData April 2018\", \"description\": \"Microsoft. (2018, April 12). CryptUnprotectData function. Retrieved June 18, 2019.\", \"url\": \"https://docs.microsoft.com/en-us/windows/desktop/api/dpapi/nf-dpapi-cryptunprotectdata\"}, {\"source_name\": \"Proofpoint Vega Credential Stealer May 2018\", \"description\": \"Proofpoint. (2018, May 10). New Vega Stealer shines brightly in targeted campaign . Retrieved June 18, 2019.\", \"url\": \"https://www.proofpoint.com/us/threat-insight/post/new-vega-stealer-shines-brightly-targeted-campaign\"}, {\"source_name\": \"FireEye HawkEye Malware July 2017\", \"description\": \"Swapnil Patil, Yogesh Londhe. (2017, July 25). HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign. Retrieved June 18, 2019.\", \"url\": \"https://www.fireeye.com/blog/threat-research/2017/07/hawkeye-malware-distributed-in-phishing-campaign.html\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Ryan Benson, Exabeam\", \"Barry Shteiman, Exabeam\", \"Sylvain Gil, Exabeam\", \"RedHuntLabs, @redhuntlabs\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"Process: Process Access\", \"File: File Access\", \"Process: OS API Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Identify web browser files that contain credentials such as Google Chrome\\u2019s Login Data database file: <code>AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data</code>. Monitor file read events of web browser files that contain credentials, especially when the reading process is unrelated to the subject web browser. Monitor process execution logs to include PowerShell Transcription focusing on those that perform a combination of behaviors including reading web browser process memory, utilizing regular expressions, and those that contain numerous keywords for common web applications (Gmail, Twitter, Office365, etc.).\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\"], \"x_mitre_version\": \"1.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--5d3f58bf-2192-46f9-bba3-27e917b75df6\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-19T23:18:35.459Z\", \"modified\": \"2025-04-28T15:49:54.240Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-04T12:52:13.006Z\", \"modified\": \"2025-04-15T19:58:47.301Z\", \"name\": \"Credentials In Files\", \"description\": \"Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.\\n\\nIt is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003).(Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller.(Citation: SRD GPP)\\n\\nIn cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.(Citation: Unit 42 Hildegard Malware) They may also be found as parameters to deployment commands in container logs.(Citation: Unit 42 Unsecured Docker Daemons) In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.(Citation: Specter Ops - Cloud Credential Storage)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1552/001\", \"external_id\": \"T1552.001\"}, {\"source_name\": \"CG 2014\", \"description\": \"CG. (2014, May 20). Mimikatz Against Virtual Machine Memory Part 1. Retrieved November 12, 2014.\", \"url\": \"http://carnal0wnage.attackresearch.com/2014/05/mimikatz-against-virtual-machine-memory.html\"}, {\"source_name\": \"Unit 42 Hildegard Malware\", \"description\": \"Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.\", \"url\": \"https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/\"}, {\"source_name\": \"Unit 42 Unsecured Docker Daemons\", \"description\": \"Chen, J.. (2020, January 29). Attacker's Tactics and Techniques in Unsecured Docker Daemons Revealed. Retrieved March 31, 2021.\", \"url\": \"https://unit42.paloaltonetworks.com/attackers-tactics-and-techniques-in-unsecured-docker-daemons-revealed/\"}, {\"source_name\": \"Specter Ops - Cloud Credential Storage\", \"description\": \"Maddalena, C.. (2018, September 12). Head in the Clouds. Retrieved October 4, 2019.\", \"url\": \"https://posts.specterops.io/head-in-the-clouds-bd038bb69e48\"}, {\"source_name\": \"SRD GPP\", \"description\": \"Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015.\", \"url\": \"http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Rory McCune, Aqua Security\", \"Jay Chen, Palo Alto Networks\", \"Yossi Weizman, Azure Defender Research Team\", \"Vishwas Manral, McAfee\", \"Microsoft Threat Intelligence Center (MSTIC)\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"Process: Process Creation\", \"File: File Access\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"While detecting adversaries accessing these files may be difficult without knowing they exist in the first place, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). See [Valid Accounts](https://attack.mitre.org/techniques/T1078) for more information.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"IaaS\", \"Linux\", \"macOS\", \"Containers\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--86847d37-f7da-4c30-ab48-2da87e6c1cff\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-19T23:18:35.420Z\", \"modified\": \"2025-04-28T15:57:38.190Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-21T16:22:09.493Z\", \"modified\": \"2025-04-15T22:44:50.491Z\", \"name\": \"LSA Secrets\", \"description\": \"Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\\\SECURITY\\\\Policy\\\\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets)\\n\\n[Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1003/004\", \"external_id\": \"T1003.004\"}, {\"source_name\": \"Tilbury Windows Credentials\", \"description\": \"Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.\", \"url\": \"https://www.first.org/resources/papers/conf2017/Windows-Credentials-Attacks-and-Mitigation-Techniques.pdf\"}, {\"source_name\": \"ired Dumping LSA Secrets\", \"description\": \"Mantvydas Baranauskas. (2019, November 16). Dumping LSA Secrets. Retrieved February 21, 2020.\", \"url\": \"https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsa-secrets\"}, {\"source_name\": \"Microsoft AD Admin Tier Model\", \"description\": \"Microsoft. (2019, February 14). Active Directory administrative tier model. Retrieved February 21, 2020.\", \"url\": \"https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material?redirectedfrom=MSDN\"}, {\"source_name\": \"Passcape LSA Secrets\", \"description\": \"Passcape. (n.d.). Windows LSA secrets. Retrieved February 21, 2020.\", \"url\": \"https://www.passcape.com/index.php?section=docsys&cmd=details&id=23\"}, {\"source_name\": \"Powersploit\", \"description\": \"PowerSploit. (n.d.). Retrieved December 4, 2014.\", \"url\": \"https://github.com/mattifestation/PowerSploit\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Ed Williams, Trustwave, SpiderLabs\"], \"x_mitre_data_sources\": [\"Windows Registry: Windows Registry Key Access\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--8ffeeb33-0757-4b74-a4ae-504145bc473f\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-19T23:18:35.426Z\", \"modified\": \"2025-04-28T15:59:29.981Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used several tools for retrieving login and password information, including LaZagne.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-14T17:19:50.978Z\", \"modified\": \"2025-04-25T14:47:03.621Z\", \"name\": \"Process Doppelg\\u00e4nging\", \"description\": \"Adversaries may inject malicious code into process via process doppelg\\u00e4nging in order to evade process-based defenses as well as possibly elevate privileges. Process doppelg\\u00e4nging is a method of executing arbitrary code in the address space of a separate live process. \\n\\nWindows Transactional NTFS (TxF) was introduced in Vista as a method to perform safe file operations. (Citation: Microsoft TxF) To ensure data integrity, TxF enables only one transacted handle to write to a file at a given time. Until the write handle transaction is terminated, all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened. (Citation: Microsoft Basic TxF Concepts) To avoid corruption, TxF performs an automatic rollback if the system or application fails during a write transaction. (Citation: Microsoft Where to use TxF)\\n\\nAlthough deprecated, the TxF application programming interface (API) is still enabled as of Windows 10. (Citation: BlackHat Process Doppelg\\u00e4nging Dec 2017)\\n\\nAdversaries may abuse TxF to a perform a file-less variation of [Process Injection](https://attack.mitre.org/techniques/T1055). Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), process doppelg\\u00e4nging involves replacing the memory of a legitimate process, enabling the veiled execution of malicious code that may evade defenses and detection. Process doppelg\\u00e4nging's use of TxF also avoids the use of highly-monitored API functions such as <code>NtUnmapViewOfSection</code>, <code>VirtualProtectEx</code>, and <code>SetThreadContext</code>. (Citation: BlackHat Process Doppelg\\u00e4nging Dec 2017)\\n\\nProcess Doppelg\\u00e4nging is implemented in 4 steps (Citation: BlackHat Process Doppelg\\u00e4nging Dec 2017):\\n\\n* Transact \\u2013 Create a TxF transaction using a legitimate executable then overwrite the file with malicious code. These changes will be isolated and only visible within the context of the transaction.\\n* Load \\u2013 Create a shared section of memory and load the malicious executable.\\n* Rollback \\u2013 Undo changes to original executable, effectively removing malicious code from the file system.\\n* Animate \\u2013 Create a process from the tainted section of memory and initiate execution.\\n\\nThis behavior will likely not result in elevated privileges since the injected process was spawned from (and thus inherits the security context) of the injecting process. However, execution via process doppelg\\u00e4nging may evade detection from security products since the execution is masked under a legitimate process. \", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"defense-evasion\"}, {\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"privilege-escalation\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1055/013\", \"external_id\": \"T1055.013\"}, {\"source_name\": \"Microsoft TxF\", \"description\": \"Microsoft. (n.d.). Transactional NTFS (TxF). Retrieved December 20, 2017.\", \"url\": \"https://msdn.microsoft.com/library/windows/desktop/bb968806.aspx\"}, {\"source_name\": \"Microsoft Basic TxF Concepts\", \"description\": \"Microsoft. (n.d.). Basic TxF Concepts. Retrieved December 20, 2017.\", \"url\": \"https://msdn.microsoft.com/library/windows/desktop/dd979526.aspx\"}, {\"source_name\": \"Microsoft Where to use TxF\", \"description\": \"Microsoft. (n.d.). When to Use Transactional NTFS. Retrieved December 20, 2017.\", \"url\": \"https://msdn.microsoft.com/library/windows/desktop/aa365738.aspx\"}, {\"source_name\": \"BlackHat Process Doppelg\\u00e4nging Dec 2017\", \"description\": \"Liberman, T. & Kogan, E. (2017, December 7). Lost in Transaction: Process Doppelg\\u00e4nging. Retrieved December 20, 2017.\", \"url\": \"https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf\"}, {\"source_name\": \"hasherezade Process Doppelg\\u00e4nging Dec 2017\", \"description\": \"hasherezade. (2017, December 18). Process Doppelg\\u00e4nging \\u2013 a new way to impersonate a process. Retrieved December 20, 2017.\", \"url\": \"https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/\"}, {\"source_name\": \"Microsoft PsSetCreateProcessNotifyRoutine routine\", \"description\": \"Microsoft. (n.d.). PsSetCreateProcessNotifyRoutine routine. Retrieved December 20, 2017.\", \"url\": \"https://msdn.microsoft.com/library/windows/hardware/ff559951.aspx\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_data_sources\": [\"File: File Metadata\", \"Process: OS API Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor and analyze calls to <code>CreateTransaction</code>, <code>CreateFileTransacted</code>, <code>RollbackTransaction</code>, and other rarely used functions indicative of TxF activity. Process Doppelg\\u00e4nging also invokes an outdated and undocumented implementation of the Windows process loader via calls to <code>NtCreateProcessEx</code> and <code>NtCreateThreadEx</code> as well as API calls used to modify memory within another process, such as <code>WriteProcessMemory</code>. (Citation: BlackHat Process Doppelg\\u00e4nging Dec 2017) (Citation: hasherezade Process Doppelg\\u00e4nging Dec 2017)\\n\\nScan file objects reported during the PsSetCreateProcessNotifyRoutine, (Citation: Microsoft PsSetCreateProcessNotifyRoutine routine) which triggers a callback whenever a process is created or deleted, specifically looking for file objects with enabled write access. (Citation: BlackHat Process Doppelg\\u00e4nging Dec 2017) Also consider comparing file objects loaded in memory to the corresponding file on disk. (Citation: hasherezade Process Doppelg\\u00e4nging Dec 2017)\\n\\nAnalyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--926c11f2-853f-4393-9faf-2f3af174e578\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-03-18T22:00:45.497Z\", \"modified\": \"2025-04-28T15:59:57.010Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) has used [Process Doppelg\\u00e4nging](https://attack.mitre.org/techniques/T1055/013) to evade security software while deploying tools on compromised systems.(Citation: Symantec Leafminer July 2018)\\t\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-04-18T17:59:24.739Z\", \"modified\": \"2025-04-15T19:59:12.900Z\", \"name\": \"Drive-by Compromise\", \"description\": \"Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. Multiple ways of delivering exploit code to a browser exist (i.e., [Drive-by Target](https://attack.mitre.org/techniques/T1608/004)), including:\\n\\n* A legitimate website is compromised, allowing adversaries to inject malicious code\\n* Script files served to a legitimate website from a publicly writeable cloud storage bucket are modified by an adversary\\n* Malicious ads are paid for and served through legitimate ad providers (i.e., [Malvertising](https://attack.mitre.org/techniques/T1583/008))\\n* Built-in web application interfaces that allow user-controllable content are leveraged for the insertion of malicious scripts or iFrames (e.g., cross-site scripting)\\n\\nBrowser push notifications may also be abused by adversaries and leveraged for malicious code injection via [User Execution](https://attack.mitre.org/techniques/T1204). By clicking \\\"allow\\\" on browser push notifications, users may be granting a website permission to run JavaScript code on their browser.(Citation: Push notifications - viruspositive)(Citation: push notification -mcafee)(Citation: push notifications - malwarebytes)\\n\\nOften the website used by an adversary is one visited by a specific community, such as government, a particular industry, or a particular region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted campaign is often referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Shadowserver Strategic Web Compromise)\\n\\nTypical drive-by compromise process:\\n\\n1. A user visits a website that is used to host the adversary controlled content.\\n2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. The user may be required to assist in this process by enabling scripting, notifications, or active website components and ignoring warning dialog boxes.\\n3. Upon finding a vulnerable version, exploit code is delivered to the browser.\\n4. If exploitation is successful, the adversary will gain code execution on the user's system unless other protections are in place. In some cases, a second visit to the website after the initial scan is required before exploit code is delivered.\\n\\nUnlike [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"initial-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1189\", \"external_id\": \"T1189\"}, {\"source_name\": \"Shadowserver Strategic Web Compromise\", \"description\": \"Adair, S., Moran, N. (2012, May 15). Cyber Espionage & Strategic Web Compromises \\u2013 Trusted Websites Serving Dangerous Results. Retrieved March 13, 2018.\", \"url\": \"http://blog.shadowserver.org/2012/05/15/cyber-espionage-strategic-web-compromises-trusted-websites-serving-dangerous-results/\"}, {\"source_name\": \"push notification -mcafee\", \"description\": \"Craig Schmugar. (2021, May 17). Scammers Impersonating Windows Defender to Push Malicious Windows Apps. Retrieved March 14, 2025.\", \"url\": \"https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-impersonating-windows-defender-to-push-malicious-windows-apps/\"}, {\"source_name\": \"Push notifications - viruspositive\", \"description\": \"Gaurav Sethi. (2021, December 14). The Dark Side of Web Push Notifications. Retrieved March 14, 2025.\", \"url\": \"https://viruspositive.com/resources/blogs/the-dark-side-of-web-push-notifications\"}, {\"source_name\": \"push notifications - malwarebytes\", \"description\": \"Pieter Arntz. (2019, January 22). Browser push notifications: a feature asking to be abused. Retrieved March 14, 2025.\", \"url\": \"https://www.malwarebytes.com/blog/news/2019/01/browser-push-notifications-feature-asking-abused\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)\", \"Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)\", \"Frank Angiolelli\"], \"x_mitre_data_sources\": [\"Application Log: Application Log Content\", \"Network Traffic: Network Traffic Content\", \"Process: Process Creation\", \"File: File Creation\", \"Network Traffic: Network Connection Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Firewalls and proxies can inspect URLs for potentially known-bad domains or parameters. They can also do reputation-based analytics on websites and their requested resources such as how old a domain is, who it's registered to, if it's on a known bad list, or how many other users have connected to it before.\\n\\nNetwork intrusion detection systems, sometimes with SSL/TLS inspection, can be used to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.\\n\\nDetecting compromise based on the drive-by exploit from a legitimate website may be difficult. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of browser processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"Linux\", \"macOS\", \"Identity Provider\"], \"x_mitre_version\": \"1.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--bad12e35-72da-43bb-b61b-505ed72883c5\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:07:15.490Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) has infected victims using watering holes.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:30:28.187Z\", \"modified\": \"2025-04-15T19:59:15.859Z\", \"name\": \"Remote System Discovery\", \"description\": \"Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097), <code>net view</code> using [Net](https://attack.mitre.org/software/S0039), or, on ESXi servers, `esxcli network diag ping`.\\n\\nAdversaries may also analyze data from local host files (ex: <code>C:\\\\Windows\\\\System32\\\\Drivers\\\\etc\\\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099) cache entries) in order to discover the presence of remote systems in an environment.\\n\\nAdversaries may also target discovery of network infrastructure as well as leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on network devices to gather detailed information about systems within a network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS May 2021)  \\n\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1018\", \"external_id\": \"T1018\"}, {\"source_name\": \"CISA AR21-126A FIVEHANDS May 2021\", \"description\": \"CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.\", \"url\": \"https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a\"}, {\"source_name\": \"Elastic - Koadiac Detection with EQL\", \"description\": \"Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 17, 2024.\", \"url\": \"https://www.elastic.co/security-labs/embracing-offensive-tooling-building-detections-against-koadic-using-eql\"}, {\"source_name\": \"US-CERT-TA18-106A\", \"description\": \"US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-106A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Daniel Stepanic, Elastic\", \"RedHuntLabs, @redhuntlabs\", \"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"File: File Access\", \"Network Traffic: Network Connection Creation\", \"Process: Process Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nMonitor for processes that can be used to discover remote systems, such as <code>ping.exe</code> and <code>tracert.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"3.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--bfb1e467-dffc-463b-9f38-a3fafbb9d036\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:08:09.564Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used Microsoft\\u2019s Sysinternals tools to gather detailed information about remote systems.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-11T18:39:25.122Z\", \"modified\": \"2025-04-15T19:58:38.420Z\", \"name\": \"Password Spraying\", \"description\": \"Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. (Citation: BlackHillsInfosec Password Spraying)\\n\\nTypically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:\\n\\n* SSH (22/TCP)\\n* Telnet (23/TCP)\\n* FTP (21/TCP)\\n* NetBIOS / SMB / Samba (139/TCP & 445/TCP)\\n* LDAP (389/TCP)\\n* Kerberos (88/TCP)\\n* RDP / Terminal Services (3389/TCP)\\n* HTTP/HTTP Management Services (80/TCP & 443/TCP)\\n* MSSQL (1433/TCP)\\n* Oracle (1521/TCP)\\n* MySQL (3306/TCP)\\n* VNC (5900/TCP)\\n\\nIn addition to management services, adversaries may \\\"target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols,\\\" as well as externally facing email applications, such as Office 365.(Citation: US-CERT TA18-068A 2018)\\n\\nIn default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows \\\"logon failure\\\" event ID 4625.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"credential-access\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1110/003\", \"external_id\": \"T1110.003\"}, {\"source_name\": \"Trimarc Detecting Password Spraying\", \"description\": \"Metcalf, S. (2018, May 6). Trimarc Research: Detecting Password Spraying with Security Event Auditing. Retrieved January 16, 2019.\", \"url\": \"https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing\"}, {\"source_name\": \"BlackHillsInfosec Password Spraying\", \"description\": \"Thyer, J. (2015, October 30). Password Spraying & Other Fun with RPCCLIENT. Retrieved April 25, 2017.\", \"url\": \"http://www.blackhillsinfosec.com/?p=4645\"}, {\"source_name\": \"US-CERT TA18-068A 2018\", \"description\": \"US-CERT. (2018, March 27). TA18-068A Brute Force Attacks Conducted by Cyber Actors. Retrieved October 2, 2019.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-086A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Microsoft Threat Intelligence Center (MSTIC)\", \"John Strand\"], \"x_mitre_data_sources\": [\"User Account: User Account Authentication\", \"Application Log: Application Log Content\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Specifically, monitor for many failed authentication attempts across various accounts that may result from password spraying attempts.\\n\\nConsider the following event IDs:(Citation: Trimarc Detecting Password Spraying)\\n\\n* Domain Controllers: \\\"Audit Logon\\\" (Success & Failure) for event ID 4625.\\n* Domain Controllers: \\\"Audit Kerberos Authentication Service\\\" (Success & Failure) for event ID 4771.\\n* All systems: \\\"Audit Logon\\\" (Success & Failure) for event ID 4648.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Containers\", \"IaaS\", \"Identity Provider\", \"Linux\", \"Network Devices\", \"Office Suite\", \"SaaS\", \"Windows\", \"macOS\", \"ESXi\"], \"x_mitre_version\": \"1.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--c47b3759-8c59-45f7-8ae1-66b49a5359f8\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:09:03.011Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used a tool called Total SMB BruteForcer to perform internal password spraying.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--635cbe30-392d-4e27-978e-66774357c762\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-01-28T13:50:22.506Z\", \"modified\": \"2025-04-15T19:58:36.237Z\", \"name\": \"Local Account\", \"description\": \"Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. \\n\\nFor example, with a sufficient level of access, the Windows <code>net user /add</code> command can be used to create a local account.  In Linux, the `useradd` command can be used, while on macOS systems, the <code>dscl -create</code> command can be used. Local accounts may also be added to network devices, often via common [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as <code>username</code>, to ESXi servers via `esxcli system account add`, or to Kubernetes clusters using the `kubectl` utility.(Citation: cisco_username_cmd)(Citation: Kubernetes Service Accounts Security)\\n\\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"persistence\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1136/001\", \"external_id\": \"T1136.001\"}, {\"source_name\": \"cisco_username_cmd\", \"description\": \"Cisco. (2023, March 6). username - Cisco IOS Security Command Reference: Commands S to Z. Retrieved July 13, 2022.\", \"url\": \"https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/security/s1/sec-s1-cr-book/sec-cr-t2.html#wp1047035630\"}, {\"source_name\": \"Kubernetes Service Accounts Security\", \"description\": \"Kubernetes. (n.d.). Service Accounts. Retrieved July 14, 2023.\", \"url\": \"https://kubernetes.io/docs/concepts/security/service-accounts/\"}, {\"source_name\": \"Microsoft User Creation Event\", \"description\": \"Lich, B., Miroshnikov, A. (2017, April 5). 4720(S): A user account was created. Retrieved June 30, 2017.\", \"url\": \"https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4720\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"User Account: User Account Creation\", \"Process: Process Creation\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for processes and command-line parameters associated with local account creation, such as <code>net user /add</code> , <code>useradd</code> , and <code>dscl -create</code> . Collect data on account creation within a network. Event ID 4720 is generated when a user account is created on a Windows system. (Citation: Microsoft User Creation Event) Perform regular audits of local system accounts to detect suspicious accounts that may have been created by an adversary. For network infrastructure devices, collect AAA logging to monitor for account creations.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"Containers\", \"ESXi\"], \"x_mitre_version\": \"1.4\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--c6ee4856-1782-4430-af7f-4d71e84c9b97\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:09:29.887Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used a tool called Imecab to set up a persistent remote access account on the victim machine.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--635cbe30-392d-4e27-978e-66774357c762\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-06-23T19:12:24.924Z\", \"modified\": \"2025-04-15T22:43:16.394Z\", \"name\": \"JavaScript\", \"description\": \"Adversaries may abuse various implementations of JavaScript for execution. JavaScript (JS) is a platform-independent scripting language (compiled just-in-time at runtime) commonly associated with scripts in webpages, though JS can be executed in runtime environments outside the browser.(Citation: NodeJS)\\n\\nJScript is the Microsoft implementation of the same scripting standard. JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and Internet Explorer HTML Application (HTA) pages.(Citation: JScrip May 2018)(Citation: Microsoft JScript 2007)(Citation: Microsoft Windows Scripts)\\n\\nJavaScript for Automation (JXA) is a macOS scripting language based on JavaScript, included as part of Apple\\u2019s Open Scripting Architecture (OSA), that was introduced in OSX 10.10. Apple\\u2019s OSA provides scripting capabilities to control applications, interface with the operating system, and bridge access into the rest of Apple\\u2019s internal APIs. As of OSX 10.10, OSA only supports two languages, JXA and [AppleScript](https://attack.mitre.org/techniques/T1059/002). Scripts can be executed via the command line utility <code>osascript</code>, they can be compiled into applications or script files via <code>osacompile</code>, and they can be compiled and executed in memory of other programs by leveraging the OSAKit Framework.(Citation: Apple About Mac Scripting 2016)(Citation: SpecterOps JXA 2020)(Citation: SentinelOne macOS Red Team)(Citation: Red Canary Silver Sparrow Feb2021)(Citation: MDSec macOS JXA and VSCode)\\n\\nAdversaries may abuse various implementations of JavaScript to execute various behaviors. Common uses include hosting malicious scripts on websites as part of a [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) or downloading and executing these script files as secondary payloads. Since these payloads are text-based, it is also very common for adversaries to obfuscate their content as part of [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"execution\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1059/007\", \"external_id\": \"T1059.007\"}, {\"source_name\": \"Apple About Mac Scripting 2016\", \"description\": \"Apple. (2016, June 13). About Mac Scripting. Retrieved April 14, 2021.\", \"url\": \"https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/index.html\"}, {\"source_name\": \"MDSec macOS JXA and VSCode\", \"description\": \"Dominic Chell. (2021, January 1). macOS Post-Exploitation Shenanigans with VSCode Extensions. Retrieved April 20, 2021.\", \"url\": \"https://www.mdsec.co.uk/2021/01/macos-post-exploitation-shenanigans-with-vscode-extensions/\"}, {\"source_name\": \"Microsoft JScript 2007\", \"description\": \"Microsoft. (2007, August 15). The World of JScript, JavaScript, ECMAScript \\u2026. Retrieved June 23, 2020.\", \"url\": \"https://docs.microsoft.com/archive/blogs/gauravseth/the-world-of-jscript-javascript-ecmascript\"}, {\"source_name\": \"Microsoft Windows Scripts\", \"description\": \"Microsoft. (2017, January 18). Windows Script Interfaces. Retrieved June 23, 2020.\", \"url\": \"https://docs.microsoft.com/scripting/winscript/windows-script-interfaces\"}, {\"source_name\": \"JScrip May 2018\", \"description\": \"Microsoft. (2018, May 31). Translating to JScript. Retrieved June 23, 2020.\", \"url\": \"https://docs.microsoft.com/windows/win32/com/translating-to-jscript\"}, {\"source_name\": \"NodeJS\", \"description\": \"OpenJS Foundation. (n.d.). Node.js. Retrieved June 23, 2020.\", \"url\": \"https://nodejs.org/\"}, {\"source_name\": \"SentinelOne macOS Red Team\", \"description\": \"Phil Stokes. (2019, December 5). macOS Red Team: Calling Apple APIs Without Building Binaries. Retrieved July 17, 2020.\", \"url\": \"https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/\"}, {\"source_name\": \"SpecterOps JXA 2020\", \"description\": \"Pitt, L. (2020, August 6). Persistent JXA. Retrieved April 14, 2021.\", \"url\": \"https://posts.specterops.io/persistent-jxa-66e1c3cd1cf5\"}, {\"source_name\": \"Red Canary Silver Sparrow Feb2021\", \"description\": \"Tony Lambert. (2021, February 18). Clipping Silver Sparrow\\u2019s wings: Outing macOS malware before it takes flight. Retrieved April 20, 2021.\", \"url\": \"https://redcanary.com/blog/clipping-silver-sparrows-wings/\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Cody Thomas, SpecterOps\"], \"x_mitre_data_sources\": [\"Module: Module Load\", \"Process: Process Creation\", \"Script: Script Execution\", \"Command: Command Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for events associated with scripting execution, such as process activity, usage of the Windows Script Host (typically cscript.exe or wscript.exe), file activity involving scripts, or loading of modules associated with scripting languages (ex: JScript.dll). Scripting execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for execution and subsequent behavior. Actions may be related to network and system information [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), or other programmable post-compromise behaviors and could be used as indicators of detection leading back to the source.\\n\\nMonitor for execution of JXA through <code>osascript</code> and usage of <code>OSAScript</code> API that may be related to other suspicious behavior occurring on the system.\\n\\nUnderstanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable related components running on a system would be considered suspicious. If scripting is not commonly used on a system, but enabled, execution running out of cycle from patching or other administrator functions is suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"macOS\", \"Linux\"], \"x_mitre_remote_support\": false, \"x_mitre_version\": \"2.2\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--cd45bd64-3793-49e7-82d0-9cdabf417d61\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:10:42.456Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) infected victims using JavaScript code.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2020-02-19T18:52:24.547Z\", \"modified\": \"2025-04-15T22:59:50.429Z\", \"name\": \"Remote Email Collection\", \"description\": \"Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific keywords.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"collection\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1114/002\", \"external_id\": \"T1114.002\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Arun Seelagan, CISA\"], \"x_mitre_data_sources\": [\"Application Log: Application Log Content\", \"Logon Session: Logon Session Creation\", \"Command: Command Execution\", \"Network Traffic: Network Connection Creation\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"Monitor for unusual login activity from unknown or abnormal locations, especially for privileged accounts (ex: Exchange administrator account).\", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": true, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"Office Suite\"], \"x_mitre_version\": \"1.3\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--f1f879a7-cd1e-4865-bc6a-9b42d36df62b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:16:57.621Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used a tool called MailSniper to search through the Exchange server mailboxes for keywords.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"attack-pattern\", \"id\": \"attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:31:04.710Z\", \"modified\": \"2025-04-15T19:58:44.118Z\", \"name\": \"File and Directory Discovery\", \"description\": \"Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\\n\\nMany command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106). Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather file and directory information (e.g. <code>dir</code>, <code>show flash</code>, and/or <code>nvram</code>).(Citation: US-CERT-TA18-106A)\\n\\nSome files and directories may require elevated or specific user permissions to access.\", \"kill_chain_phases\": [{\"kill_chain_name\": \"mitre-attack\", \"phase_name\": \"discovery\"}], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/techniques/T1083\", \"external_id\": \"T1083\"}, {\"source_name\": \"Windows Commands JPCERT\", \"description\": \"Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.\", \"url\": \"https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html\"}, {\"source_name\": \"US-CERT-TA18-106A\", \"description\": \"US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.\", \"url\": \"https://www.us-cert.gov/ncas/alerts/TA18-106A\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Austin Clark, @c2defense\"], \"x_mitre_data_sources\": [\"Command: Command Execution\", \"Process: Process Creation\", \"Process: OS API Execution\"], \"x_mitre_deprecated\": false, \"x_mitre_detection\": \"System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.\\n\\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001). Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather file and directory information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use of commands being run by non-standard users from non-standard locations.  \", \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_is_subtechnique\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\", \"Network Devices\", \"ESXi\"], \"x_mitre_version\": \"1.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--f8a21871-d67b-4e89-82db-580d117d28fb\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:18:05.306Z\", \"relationship_type\": \"uses\", \"description\": \"[Leafminer](https://attack.mitre.org/groups/G0077) used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files.(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}], "software": [{"object": "{\"type\": \"tool\", \"id\": \"tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2019-01-30T16:44:59.887Z\", \"modified\": \"2024-04-04T03:49:27.035Z\", \"name\": \"LaZagne\", \"description\": \"[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)\", \"labels\": [\"tool\"], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/software/S0349\", \"external_id\": \"S0349\"}, {\"source_name\": \"LaZagne\", \"description\": \"(Citation: GitHub LaZange Dec 2018)\"}, {\"source_name\": \"GitHub LaZagne Dec 2018\", \"description\": \"Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.\", \"url\": \"https://github.com/AlessandroZ/LaZagne\"}, {\"source_name\": \"GitHub LaZange Dec 2018\", \"description\": \"Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.\", \"url\": \"https://github.com/AlessandroZ/LaZagne\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_aliases\": [\"LaZagne\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Linux\", \"macOS\", \"Windows\"], \"x_mitre_version\": \"1.6\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--022c1740-5adb-473e-a8b3-5b1646c959d8\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2019-01-30T16:46:41.620Z\", \"modified\": \"2025-04-28T15:31:59.782Z\", \"relationship_type\": \"uses\", \"description\": \"(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"tool\", \"id\": \"tool--afc079f3-c0ea-4096-b75d-3f05338b7f60\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:32:11.544Z\", \"modified\": \"2024-11-27T21:53:57.705Z\", \"name\": \"Mimikatz\", \"description\": \"[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)\", \"labels\": [\"tool\"], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/software/S0002\", \"external_id\": \"S0002\"}, {\"source_name\": \"Deply Mimikatz\", \"description\": \"Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.\", \"url\": \"https://github.com/gentilkiwi/mimikatz\"}, {\"source_name\": \"Adsecurity Mimikatz Guide\", \"description\": \"Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015.\", \"url\": \"https://adsecurity.org/?page_id=1821\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_aliases\": [\"Mimikatz\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Vincent Le Toux\"], \"x_mitre_deprecated\": false, \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.10\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--984a0d7f-407f-4e3b-afd5-1dc107a980d5\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:01:08.347Z\", \"relationship_type\": \"uses\", \"description\": \"(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"tool--afc079f3-c0ea-4096-b75d-3f05338b7f60\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"tool\", \"id\": \"tool--999c4e6e-b8dc-4b4f-8d6e-1b829f29997e\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2019-10-05T02:34:01.189Z\", \"modified\": \"2024-10-14T22:11:30.271Z\", \"name\": \"MailSniper\", \"description\": \"MailSniper is a penetration testing tool for searching through email in a Microsoft Exchange environment for specific terms (passwords, insider intel, network architecture information, etc.). It can be used by a non-administrative user to search their own email, or by an Exchange administrator to search the mailboxes of every user in a domain.(Citation: GitHub MailSniper)\", \"labels\": [\"tool\"], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/software/S0413\", \"external_id\": \"S0413\"}, {\"source_name\": \"GitHub MailSniper\", \"description\": \"Bullock, B., . (2018, November 20). MailSniper. Retrieved October 4, 2019.\", \"url\": \"https://github.com/dafthack/MailSniper\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_aliases\": [\"MailSniper\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\", \"Office Suite\"], \"x_mitre_version\": \"1.1\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--a55d75ab-f5bb-4892-80de-c878be26a67d\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2019-10-05T02:35:42.069Z\", \"modified\": \"2025-04-28T16:03:30.318Z\", \"relationship_type\": \"uses\", \"description\": \"(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"tool--999c4e6e-b8dc-4b4f-8d6e-1b829f29997e\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}, {"object": "{\"type\": \"tool\", \"id\": \"tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2017-05-31T21:32:21.771Z\", \"modified\": \"2024-09-25T20:31:21.768Z\", \"name\": \"PsExec\", \"description\": \"[PsExec](https://attack.mitre.org/software/S0029) is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers.(Citation: Russinovich Sysinternals)(Citation: SANS PsExec)\", \"labels\": [\"tool\"], \"external_references\": [{\"source_name\": \"mitre-attack\", \"url\": \"https://attack.mitre.org/software/S0029\", \"external_id\": \"S0029\"}, {\"source_name\": \"SANS PsExec\", \"description\": \"Pilkington, M. (2012, December 17). Protecting Privileged Domain Accounts: PsExec Deep-Dive. Retrieved August 17, 2016.\", \"url\": \"https://www.sans.org/blog/protecting-privileged-domain-accounts-psexec-deep-dive/\"}, {\"source_name\": \"Russinovich Sysinternals\", \"description\": \"Russinovich, M. (2014, May 2). Windows Sysinternals PsExec v2.11. Retrieved May 13, 2015.\", \"url\": \"https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_aliases\": [\"PsExec\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_contributors\": [\"Janantha Marasinghe\"], \"x_mitre_deprecated\": false, \"x_mitre_domains\": [\"enterprise-attack\"], \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"x_mitre_platforms\": [\"Windows\"], \"x_mitre_version\": \"1.7\"}", "relationship": "{\"type\": \"relationship\", \"id\": \"relationship--d2a8729f-6271-46a0-8a40-a8567c9e5092\", \"created_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\", \"created\": \"2018-10-17T00:14:20.652Z\", \"modified\": \"2025-04-28T16:11:39.997Z\", \"relationship_type\": \"uses\", \"description\": \"(Citation: Symantec Leafminer July 2018)\", \"source_ref\": \"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74\", \"target_ref\": \"tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db\", \"external_references\": [{\"source_name\": \"Symantec Leafminer July 2018\", \"description\": \"Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.\", \"url\": \"https://www.symantec.com/blogs/threat-intelligence/leafminer-espionage-middle-east\"}], \"object_marking_refs\": [\"marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168\"], \"x_mitre_attack_spec_version\": \"3.2.0\", \"x_mitre_deprecated\": false, \"x_mitre_modified_by_ref\": \"identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5\"}"}], "actor_techniques_software_map": {"attack-pattern--d511a6f6-4a33-41d5-bc95-c343875d1377": [], "attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0": [], "attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90": [], "attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0": [], "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88": [], "attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530": [], "attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8": [], "attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc": [], "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc": [], "attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197": [], "attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6": [], "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735": [], "attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c": [], "attack-pattern--635cbe30-392d-4e27-978e-66774357c762": [], "attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d": [], "attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a": [], "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18": []}, "actor_techniques_to_tactics_map": {"TA0042": ["attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0"], "TA0001": ["attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6"], "TA0002": ["attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d"], "TA0003": ["attack-pattern--635cbe30-392d-4e27-978e-66774357c762"], "TA0004": ["attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197"], "TA0005": ["attack-pattern--d511a6f6-4a33-41d5-bc95-c343875d1377", "attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197"], "TA0006": ["attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90", "attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0", "attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530", "attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8", "attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc", "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc", "attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c"], "TA0007": ["attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88", "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735", "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18"], "TA0009": ["attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a"]}, "indicators": {"intrusion-set--32bca8ff-d900-4877-aa65-d70baa041b74": [null, null], "tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b": [{"type": "bundle", "id": "bundle--8f0f0a0d-9d77-4bfc-b6f1-6bd46a9f6a77", "objects": [{"type": "indicator", "spec_version": "2.1", "id": "indicator--4e7b5b63-4d6e-4f2d-bc87-0f3f86e9c201", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "LaZagne release tag URL", "description": "Direct link to LaZagne standalone binaries.", "pattern_type": "stix", "pattern": "[url:value = 'https://github.com/AlessandroZ/LaZagne/releases/tag/v2.4.7']", "valid_from": "2025-04-10T00:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--06d5e338-1606-466d-9f06-cdde3f6caa71", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "LaZagne releases directory", "description": "Directory hosting all LaZagne binaries.", "pattern_type": "stix", "pattern": "[url:value = 'https://github.com/AlessandroZ/LaZagne/releases/']", "valid_from": "2025-04-10T00:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--2b0f9e18-36f0-4b32-baa3-38a7b0709ae2", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Pupy RAT GitHub repository", "description": "Repository of the Pupy remote-access tool referenced as a post-exploitation module.", "pattern_type": "stix", "pattern": "[url:value = 'https://github.com/n1nj4sec/pupy/']", "valid_from": "2025-04-10T00:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--16927f73-790a-4c22-9c44-2d9b7d61f1b8", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "PayPal donation URL", "description": "Payment URL promoted by the project maintainer.", "pattern_type": "stix", "pattern": "[url:value = 'https://www.paypal.me/lazagneproject']", "valid_from": "2025-04-10T00:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--3df0f4b8-6784-4e21-9e8d-d0f89bc29538", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "Bitcoin donation address", "description": "BTC address used to receive cryptocurrency donations for the LaZagne project.", "pattern_type": "stix", "pattern": "[x-crypto-address:value = '16zJ9wTXU4f1qfMLiWvdY3woUHtEBxyriu']", "valid_from": "2025-04-10T00:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--7e048379-159f-42d1-bc1d-3c8d4c4e0675", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "LaZagne project domain", "description": "Primary domain hosting the project\u2019s source code.", "pattern_type": "stix", "pattern": "[domain-name:value = 'github.com']", "valid_from": "2025-04-10T00:00:00Z"}]}], "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60": [{"type": "bundle", "id": "bundle--e4d3c6fb-6c2a-48b8-bb7d-759eb2e5b4a1", "spec_version": "2.1", "objects": [{"type": "indicator", "id": "indicator--1aa9d719-ef24-4cab-bad1-7da027b26f31", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "File hash \u2013 d0e9aee149655a6075e4540af1f22d3b", "indicator_types": ["malicious-activity"], "pattern": "[file:hashes.'MD5' = 'd0e9aee149655a6075e4540af1f22d3b']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--9e3ef62a-7cc0-45b3-bae0-8b28c6be3b80", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "File hash \u2013 cc36cf7a8514893efccd332446158b1a", "indicator_types": ["malicious-activity"], "pattern": "[file:hashes.'MD5' = 'cc36cf7a8514893efccd332446158b1a']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--09e3a6e5-7e9c-431f-b14e-4897fa68c8f0", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "File hash \u2013 a299912f3dc7cf0023aef8e4361abfc03e9a8c30", "indicator_types": ["malicious-activity"], "pattern": "[file:hashes.'SHA1' = 'a299912f3dc7cf0023aef8e4361abfc03e9a8c30']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--14b62a05-4ab5-4fb6-bcf9-7c4340c3411c", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "File hash \u2013 f193d757b4d487ab7e5a3743f038f713", "indicator_types": ["malicious-activity"], "pattern": "[file:hashes.'MD5' = 'f193d757b4d487ab7e5a3743f038f713']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--f52a3890-7505-4ae9-ae09-55911801fdbe", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "File hash \u2013 310b643c5316c8c3c70a10cfb17e2e31", "indicator_types": ["malicious-activity"], "pattern": "[file:hashes.'MD5' = '310b643c5316c8c3c70a10cfb17e2e31']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--4f2549d6-2a3f-4fa3-86b9-59249698e4f2", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "Hostname \u2013 vm-w7-ult-x", "indicator_types": ["compromised"], "pattern": "[domain-name:value = 'vm-w7-ult-x']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--ae9dda75-6812-4b77-9d9d-7dc89e551fc2", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "Hostname \u2013 winxp", "indicator_types": ["compromised"], "pattern": "[domain-name:value = 'winxp']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--b4c0e053-9466-4b2d-987e-4e4f9ac88b1e", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "Domain \u2013 lab.local", "indicator_types": ["compromised"], "pattern": "[domain-name:value = 'lab.local']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--2df1b933-4789-49aa-bc42-5e1d92ff171d", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "Domain \u2013 chocolate.local", "indicator_types": ["compromised"], "pattern": "[domain-name:value = 'chocolate.local']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--30a258ba-c19d-406d-9fc8-490055e4c7d1", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "E-mail address \u2013 benjamin@gentilkiwi.com", "indicator_types": ["compromised"], "pattern": "[email-addr:value = 'benjamin@gentilkiwi.com']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--5d1182e5-7d2a-4159-9ddb-14834a5581a1", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "E-mail address \u2013 vincent.letoux@gmail.com", "indicator_types": ["compromised"], "pattern": "[email-addr:value = 'vincent.letoux@gmail.com']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--8b6dceb8-5a2e-4e1e-8d4c-1e4d9ec0d2b7", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "URL \u2013 https://blog.gentilkiwi.com/mimikatz", "indicator_types": ["malicious-activity"], "pattern": "[url:value = 'https://blog.gentilkiwi.com/mimikatz']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}, {"type": "indicator", "id": "indicator--6e8bcea5-d369-41f3-a99a-cfa486bcdbe6", "created": "2025-07-26T00:00:00Z", "modified": "2025-07-26T00:00:00Z", "name": "URL \u2013 https://github.com/gentilkiwi/mimikatz", "indicator_types": ["malicious-activity"], "pattern": "[url:value = 'https://github.com/gentilkiwi/mimikatz']", "pattern_type": "stix", "valid_from": "2025-07-26T00:00:00Z"}]}], "tool--999c4e6e-b8dc-4b4f-8d6e-1b829f29997e": [], "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db": [{"type": "bundle", "id": "bundle--4f5d76e4-2b2e-4c17-a39d-0ee06b6b2fcb", "spec_version": "2.1", "objects": [{"type": "identity", "id": "identity--0fb75eb4-a321-4fe9-9d9a-8e49e2b1a237", "name": "AI-generated Threat Intelligence", "identity_class": "analysis", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z"}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--1e3e6acd-5393-4be9-a255-67ec67d3faad", "created_by_ref": "identity--0fb75eb4-a321-4fe9-9d9a-8e49e2b1a237", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "PsTools download URL", "description": "Direct download link for the Sysinternals PsTools archive \u2013 commonly fetched by adversaries to obtain PsExec.", "indicator_types": ["malicious-activity"], "pattern": "[url:value = 'https://download.sysinternals.com/files/PSTools.zip']", "pattern_type": "stix", "valid_from": "2025-07-26T12:00:00Z", "labels": ["url"]}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--b72e4aa3-0571-4f33-a9ee-c2469f3c3cbf", "created_by_ref": "identity--0fb75eb4-a321-4fe9-9d9a-8e49e2b1a237", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "PsExec binary execution", "description": "Detection of the PsExec executable on disk or running in memory.", "indicator_types": ["malicious-activity"], "pattern": "[file:name = 'psexec.exe' OR process:name = 'psexec.exe']", "pattern_type": "stix", "valid_from": "2025-07-26T12:00:00Z", "labels": ["file", "process"]}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--2ce1b168-f7ed-41d1-9be0-1462ed1f5bb1", "created_by_ref": "identity--0fb75eb4-a321-4fe9-9d9a-8e49e2b1a237", "created": "2025-07-26T12:00:00Z", "modified": "2025-07-26T12:00:00Z", "name": "PsExec run with \u2013accepteula switch", "description": "Command-line pattern often used by automated scripts to suppress the PsExec EULA pop-up.", "indicator_types": ["malicious-activity"], "pattern": "[process:command_line MATCHES '.*psexec(\\.exe)?\\s.*-accepteula.*']", "pattern_type": "stix", "valid_from": "2025-07-26T12:00:00Z", "labels": ["process"]}]}]}}